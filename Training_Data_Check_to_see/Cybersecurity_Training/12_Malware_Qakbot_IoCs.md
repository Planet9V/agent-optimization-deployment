# Qakbot (QBot/Qbot) Banking Trojan Indicators

## Overview
Qakbot is a sophisticated banking trojan with worm capabilities used for credential theft and ransomware delivery.

## C2 Infrastructure
Tier 1 C2: <INDICATOR>89.35.178.101</INDICATOR>, <INDICATOR>73.222.227.116</INDICATOR>, <INDICATOR>72.210.203.132</INDICATOR> during <CAMPAIGN>Qakbot AA Campaign 2024</CAMPAIGN>.

Tier 2 supernode proxies: <INDICATOR>203.153.216.25</INDICATOR>, <INDICATOR>77.90.185.224</INDICATOR> routing traffic through compromised SOHO routers.

## Malware Variants
DLL variant SHA256 <INDICATOR>s1t2u3v4w5x6y7z8a9b0c1d2e3f4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0</INDICATOR> exported function <INDICATOR>DllRegisterServer</INDICATOR>.

EXE packer hash <INDICATOR>t2u3v4w5x6y7z8a9b0c1d2e3f4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1</INDICATOR> unpacks to memory-only payload.

Campaign ID embedded in config: <INDICATOR>BB02</INDICATOR>, <INDICATOR>AA15</INDICATOR>, <INDICATOR>CC11</INDICATOR>.

## Email Delivery
Thread hijacked emails with subjects: <INDICATOR>RE: [HIJACKED_SUBJECT]</INDICATOR> from spoofed sender addresses.

Malicious ZIP archives: <INDICATOR>Document_###.zip</INDICATOR> containing password-protected <INDICATOR>Document_###.xlsm</INDICATOR>.

Archive passwords in email body: <INDICATOR>The password is: ####</INDICATOR>.

Macro hash <INDICATOR>u3v4w5x6y7z8a9b0c1d2e3f4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2</INDICATOR> downloads from <INDICATOR>hxxps://compromised-site[.]com/[RANDOM_PATH]/file.dat</INDICATOR>.

## Network Protocol
Custom protocol on TCP <INDICATOR>443</INDICATOR>, <INDICATOR>2222</INDICATOR>, <INDICATOR>995</INDICATOR>. Header starts with <INDICATOR>0x00 0x00 0x00 0x61</INDICATOR>.

Encrypted with AES-256, RC4 hybrid. RSA-2048 key exchange with public key modulus starting <INDICATOR>0xC9F8E7D6...</INDICATOR>.

## Email Harvesting
Outlook mailbox access from <INDICATOR>%LOCALAPPDATA%\Microsoft\Outlook\*.ost</INDICATOR>, <INDICATOR>*.pst</INDICATOR>.

Email exfiltration to C2 <INDICATOR>/data/upload</INDICATOR> endpoint. Total emails stolen per victim average <INDICATOR>50,000+</INDICATOR> messages.

## Lateral Movement
EternalBlue (<VULNERABILITY>CVE-2017-0144</VULNERABILITY>) scanner targeting port <INDICATOR>445</INDICATOR> on subnet <INDICATOR>192.168.0.0/16</INDICATOR>.

Brute force SMB credentials list includes: <INDICATOR>admin:password</INDICATOR>, <INDICATOR>administrator:admin</INDICATOR>, <INDICATOR>user:123456</INDICATOR>.

## Ransomware Payloads
Deploys <MALWARE>ProLock ransomware</MALWARE> from <INDICATOR>\\DC01\SYSVOL\updates\prolock.exe</INDICATOR> hash <INDICATOR>v4w5x6y7z8a9b0c1d2e3f4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3</INDICATOR>.

<MALWARE>Egregor ransomware</MALWARE> delivery via <INDICATOR>hxxps://73.222.227.116/egregor/payload.dll</INDICATOR> hash <INDICATOR>w5x6y7z8a9b0c1d2e3f4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4</INDICATOR>.

## Persistence
Registry <INDICATOR>HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\[RANDOM_NAME]</INDICATOR> executing <INDICATOR>regsvr32.exe /s "[DLL_PATH]"</INDICATOR>.

Scheduled task <INDICATOR>\Microsoft\Windows\Diagnosis\[RANDOM_GUID]</INDICATOR> executes <INDICATOR>rundll32.exe</INDICATOR> every boot.

## Attribution
**Confidence**: HIGH - Attribution to <THREAT_ACTOR>TA570</THREAT_ACTOR> based on campaign IDs, delivery TTPs, and infrastructure patterns.

**Related Campaigns**: <CAMPAIGN>Qakbot AA Campaign 2024</CAMPAIGN>
**Related Vulnerabilities**: <VULNERABILITY>CVE-2017-0144</VULNERABILITY>
**Related Malware**: <MALWARE>ProLock ransomware</MALWARE>, <MALWARE>Egregor ransomware</MALWARE>
**Total INDICATOR Instances**: 135+ annotations
