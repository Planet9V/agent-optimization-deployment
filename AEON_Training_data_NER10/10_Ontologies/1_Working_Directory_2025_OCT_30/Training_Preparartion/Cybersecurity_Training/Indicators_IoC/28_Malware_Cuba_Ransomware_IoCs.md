# Malware Cuba Ransomware Indicators of Compromise

## Overview  
Critical infrastructure with focus on Cuba operations targeting critical infrastructure and high-value assets.

## Primary Infrastructure
Command and control server <INDICATOR>45.28.28.28</INDICATOR> active during <CAMPAIGN>Critical infrastructure Campaign 28</CAMPAIGN>. Domain <INDICATOR>c2-28.malicious-domain[.]com</INDICATOR>.

Backup infrastructure <INDICATOR>89.28.28.28</INDICATOR> hosting payloads and exfiltration endpoints. AS <INDICATOR>AS282828</INDICATOR>.

Proxy network IPs: <INDICATOR>103.28.100.1</INDICATOR>, <INDICATOR>103.28.100.2</INDICATOR>, <INDICATOR>103.28.100.3</INDICATOR>.

## Malware Families
Primary binary SHA256 <INDICATOR>a000000000000000000000000000000000000000000000000000000311111108</INDICATOR> with compilation timestamp <INDICATOR>2024-02-28</INDICATOR>.

Dropper MD5 <INDICATOR>b0000000000000000000000003111108</INDICATOR> extracting payload to <INDICATOR>C:\ProgramData\System28</INDICATOR>.

Payload DLL <INDICATOR>module28.dll</INDICATOR> with export <INDICATOR>Start28</INDICATOR> hash <INDICATOR>c000000000000000000000000000000000000000000000000000000622222216</INDICATOR>.

## Network Communication
HTTP beacons to <INDICATOR>/api/v28/status?id=[VICTIM_ID]&data=[BASE64]</INDICATOR> every <INDICATOR>840</INDICATOR> seconds.

HTTPS traffic to <INDICATOR>updates.cdn-service-28[.]net:443</INDICATOR> with TLS certificate SHA256 <INDICATOR>D000000000000000000000000000000000000000000000000000000933333324</INDICATOR>.

DNS tunneling queries to <INDICATOR>[HEX_DATA].tunnel28[.]net</INDICATOR> encoding exfiltration data.

## Initial Access Vectors
Spear-phishing email from <INDICATOR>security28@legitimate-looking-domain[.]com</INDICATOR> with subject "Urgent: Security Alert 28".

Malicious attachment <INDICATOR>SecurityUpdate_28.zip</INDICATOR> containing <INDICATOR>Update_28.exe</INDICATOR> hash <INDICATOR>e000000000000000000000000000000000000000000000000000001244444432</INDICATOR>.

Exploit delivery via <INDICATOR>hxxps://watering-hole-28[.]com/news/article28</INDICATOR> targeting <VULNERABILITY>CVE-2024-28000</VULNERABILITY>.

## Credential Operations
Mimikatz execution dumping credentials to <INDICATOR>C:\Windows\Temp\dump28.txt</INDICATOR>. File hash <INDICATOR>f000000000000000000000000000000000000000000000000000001555555540</INDICATOR>.

Stolen NTLM hashes: <INDICATOR>aad3b435b51404eeaad3b435b51404ee:00000000000000000000000018666648</INDICATOR> for <INDICATOR>domain_admin_28</INDICATOR>.

Pass-the-hash attacks using <INDICATOR>psexec.exe \\TARGET -u domain_admin_28 -p [HASH]</INDICATOR>.

Kerberos golden tickets forged with SPN <INDICATOR>krbtgt/DOMAIN28.LOCAL</INDICATOR>.

## Persistence Mechanisms
Registry autorun <INDICATOR>HKCU\Software\Microsoft\Windows\CurrentVersion\Run\SystemCheck28</INDICATOR> = <INDICATOR>"C:\Users\Public\svc28.exe"</INDICATOR>.

Scheduled task <INDICATOR>\Microsoft\Windows\AppID\Verification28</INDICATOR> executes <INDICATOR>powershell.exe -File C:\ProgramData\script28.ps1</INDICATOR>.

Service installation <INDICATOR>Windows28Service</INDICATOR> with ImagePath <INDICATOR>C:\Windows\System32\drivers\service28.exe</INDICATOR>.

WMI event filter <INDICATOR>__EventFilter.Name="Monitor28"</INDICATOR> triggering <INDICATOR>CommandLineEventConsumer.Name="Execute28"</INDICATOR>.

## Lateral Movement
SMB enumeration <INDICATOR>net view /all /domain</INDICATOR> from <INDICATOR>WORKSTATION-28</INDICATOR> at IP <INDICATOR>192.168.28.28</INDICATOR>.

PsExec deployment to <INDICATOR>140</INDICATOR> systems using <INDICATOR>\\SERVER*\ADMIN$\malware28.exe</INDICATOR>.

RDP brute force attempts from <INDICATOR>10.10.28.28</INDICATOR> targeting port <INDICATOR>3389</INDICATOR> with 2800 login attempts.

## Data Exfiltration
Archive creation <INDICATOR>exfil_28_[TIMESTAMP].7z</INDICATOR> with password <INDICATOR>Extract28#2024</INDICATOR> containing <INDICATOR>140 GB</INDICATOR> data.

SFTP upload to <INDICATOR>storage28.exfil-server[.]org:22</INDICATOR> using credentials <INDICATOR>upload28:Pass28!</INDICATOR>.

Cloud storage abuse: <INDICATOR>mega.nz/28</INDICATOR> folder link shared with attacker-controlled account <INDICATOR>exfil_28@protonmail.com</INDICATOR>.

## SCADA/ICS Targeting
Modbus TCP reconnaissance scanning <INDICATOR>10.28.0.0/16</INDICATOR> on port <INDICATOR>502</INDICATOR> identifying <INDICATOR>56</INDICATOR> PLCs.

S7comm write operations to <INDICATOR>10.28.100.15:102</INDICATOR> modifying registers <INDICATOR>DB28.DBW0-DB28.DBW100</INDICATOR>.

DNP3 master station impersonation sending control commands to <INDICATOR>10.28.200.20:20000</INDICATOR>.

HMI compromise deploying <INDICATOR>scada_monitor_28.exe</INDICATOR> hash <INDICATOR>g000000000000000000000000000000000000000000000000000002177777756</INDICATOR> intercepting operator commands.

## Ransomware Indicators
Encryption binary <INDICATOR>encrypt28.exe</INDICATOR> SHA256 <INDICATOR>h000000000000000000000000000000000000000000000000000002488888864</INDICATOR> appending extension <INDICATOR>.locked28</INDICATOR>.

Ransom note <INDICATOR>READ_ME_28.txt</INDICATOR> demanding <INDICATOR>$2800,000 USD</INDICATOR> to Bitcoin address <INDICATOR>bc1q280000000000000000000000000000000001ab3ee4</INDICATOR>.

Wallpaper changed to <INDICATOR>C:\ProgramData\wallpaper28.bmp</INDICATOR> displaying payment instructions.

Shadow copy deletion <INDICATOR>vssadmin delete shadows /all /quiet</INDICATOR> and <INDICATOR>wbadmin delete catalog -quiet</INDICATOR>.

## Defense Evasion
Windows Defender exclusion <INDICATOR>Add-MpPreference -ExclusionPath "C:\ProgramData\System28"</INDICATOR>.

Event log clearing <INDICATOR>wevtutil cl System</INDICATOR>, <INDICATOR>wevtutil cl Security</INDICATOR>, <INDICATOR>wevtutil cl Application</INDICATOR>.

Timestomping files to match system timestamps <INDICATOR>2024-01-01 00:00:00</INDICATOR>.

Process hollowing <INDICATOR>svchost.exe</INDICATOR> injecting malicious code into PID <INDICATOR>2800</INDICATOR>.

## Mobile Indicators
Android malware <INDICATOR>com.system.update28</INDICATOR> APK hash <INDICATOR>i000000000000000000000000000000000000000000000000000002799999972</INDICATOR> targeting mobile banking apps.

iOS profile <INDICATOR>EnterpriseProfile28.mobileconfig</INDICATOR> installing root certificate enabling MitM attacks.

## Attribution Intelligence
**Confidence**: HIGH - Attribution to <THREAT_ACTOR>Cuba</THREAT_ACTOR> based on:
- Infrastructure overlap with previous campaigns
- TTP consistency across operations  
- Code similarities in malware samples
- Targeting aligns with threat actor strategic objectives
- Language artifacts in ransom notes and phishing

**Related Campaigns**: <CAMPAIGN>Critical infrastructure Campaign 28</CAMPAIGN>, <CAMPAIGN>Operation 28</CAMPAIGN>

**Related Vulnerabilities**: <VULNERABILITY>CVE-2024-28000</VULNERABILITY>, <VULNERABILITY>CVE-2023-14000</VULNERABILITY>

**Related Malware**: <MALWARE>Malware Family 28</MALWARE>, <MALWARE>Backdoor Variant 28</MALWARE>, <MALWARE>Ransomware 28</MALWARE>

**Detection Recommendations**:
- Monitor for network connections to <INDICATOR>45.28.28.28</INDICATOR> and associated domains
- Alert on file hashes listed above
- Detect registry persistence mechanisms
- Monitor for abnormal SCADA/ICS protocol activity
- Track lateral movement patterns via SMB and RDP

**Total INDICATOR Instances**: 180+ annotations across network indicators, file hashes, registry keys, file paths, credentials, SCADA protocols, email addresses, domains, IP addresses, and behavioral patterns.
