================================================================================
NEO4J SCHEMA - RELATIONSHIP TYPE SUMMARY
MITRE ATT&CK Compatibility Analysis
Generated: 2025-11-08
================================================================================

CURRENT RELATIONSHIP TYPES (‚úÖ Functional)
================================================================================

Attack Chain Relationships (Core):
-----------------------------------
CVE ‚îÄ[IS_WEAKNESS_TYPE]‚Üí CWE
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: None
    Recommended: Add reverse [:WEAKNESS_FOR] for performance

CWE ‚îÄ[ENABLES_ATTACK_PATTERN]‚Üí CAPEC
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: None
    Recommended: Rename to [:ENABLES] for brevity
    Reverse: Add [:EXPLOITS_WEAKNESS] for exploration queries

CAPEC ‚îÄ[IMPLEMENTS]‚Üí AttackTechnique
    Current: ‚úÖ Functional (also [:USES_TECHNIQUE] variant)
    Direction: Uni-directional
    Properties: mapping_source, confidence (optional)
    Issue: Overlapping semantics with USES_TECHNIQUE
    Recommended: Standardize on [:IMPLEMENTS], deprecate USES_TECHNIQUE

MITRE ATT&CK Native Relationships:
-----------------------------------
AttackTechnique ‚îÄ[PART_OF]‚Üí AttackTactic
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: None
    Coverage: 100% (from STIX import)

AttackGroup ‚îÄ[USES]‚Üí AttackTechnique
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: first_seen, last_seen, campaign (optional)
    Coverage: 100% (from STIX import)

AttackGroup ‚îÄ[USES]‚Üí AttackSoftware
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: version, platform (optional)
    Coverage: 100% (from STIX import)

AttackSoftware ‚îÄ[IMPLEMENTS]‚Üí AttackTechnique
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: None
    Coverage: 100% (from STIX import)

Document Processing Relationships:
-----------------------------------
Entity ‚îÄ[MENTIONED_IN]‚Üí Document
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: start_char, end_char, context
    Purpose: Track entity mentions in Express Attack Briefs

VULNERABILITY ‚îÄ[EXPLOITS]‚Üí CWE
    Current: ‚úÖ Functional (document-level)
    Direction: Uni-directional
    Properties: context_window, confidence
    Purpose: Document-level relationship extraction

VULNERABILITY ‚îÄ[TARGETS]‚Üí System
    Current: ‚úÖ Functional
    Direction: Uni-directional
    Properties: context
    Purpose: Attack target identification

Entity ‚îÄ[USES]‚Üí Entity
    Current: ‚úÖ Functional (document-level)
    Direction: Uni-directional
    Properties: context
    Purpose: Generic usage relationships

Entity ‚îÄ[ENABLES]‚Üí Entity
    Current: ‚úÖ Functional (document-level)
    Direction: Uni-directional
    Properties: context
    Purpose: Enablement relationships

Entity ‚îÄ[MITIGATES]‚Üí Entity
    Current: ‚úÖ Functional (document-level only)
    Direction: Uni-directional
    Properties: context
    Purpose: Mitigation relationships (NOT MITRE Mitigation entities)


MISSING RELATIONSHIP TYPES (Extension Opportunities)
================================================================================

Priority 1 - Defensive Modeling (üî¥ HIGH):
-------------------------------------------
Mitigation ‚îÄ[MITIGATES]‚Üí AttackTechnique
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: ‚úÖ Native (course-of-action)
    Properties: effectiveness, implementation_cost
    Impact: Enables defensive strategy modeling
    Implementation: Import from STIX course-of-action objects
    Expected Count: ~42 Mitigations, ~200-300 relationships

Mitigation ‚îÄ[REDUCES_RISK]‚Üí CWE
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: üîµ Extension (not native)
    Properties: risk_reduction_percentage
    Impact: Links defensive measures to root weaknesses
    Implementation: Derive from CWE‚ÜíCAPEC‚ÜíTechnique‚ÜíMitigation chains
    Expected Count: ~100-150 relationships

Priority 2 - Detection Engineering (üü° MEDIUM):
-------------------------------------------------
DataSource ‚îÄ[DETECTS]‚Üí AttackTechnique
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: ‚úÖ Native (x-mitre-data-source)
    Properties: detection_method, confidence
    Impact: Enables detection coverage analysis
    Implementation: Import from STIX x-mitre-data-source objects
    Expected Count: ~29 DataSources, ~400-500 relationships

DataSource ‚îÄ[PROVIDES_VISIBILITY]‚Üí AttackTactic
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: üîµ Extension
    Properties: coverage_percentage
    Impact: Tactic-level visibility assessment
    Implementation: Aggregate from Technique-level detections
    Expected Count: ~100-150 relationships

Priority 3 - Threat Intelligence (üü° MEDIUM):
-----------------------------------------------
Campaign ‚îÄ[ATTRIBUTED_TO]‚Üí AttackGroup
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: ‚úÖ Native (campaign objects)
    Properties: confidence, timeframe
    Impact: Campaign tracking and attribution
    Implementation: Import from STIX campaign objects
    Expected Count: ~50-100 Campaigns, ~80-150 relationships

AttackGroup ‚îÄ[TARGETS]‚Üí Industry/Geography
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: üîµ Extension
    Properties: targeting_frequency
    Impact: Threat landscape analysis
    Implementation: Extract from ATT&CK Group descriptions
    Expected Count: Variable based on taxonomy

Priority 4 - Granular Tactics (üü¢ LOW):
-----------------------------------------
SubTechnique ‚îÄ[SUBTECHNIQUE_OF]‚Üí AttackTechnique
    Status: ‚ö†Ô∏è FLATTENED (sub-techniques stored as Technique nodes)
    MITRE ATT&CK: ‚úÖ Native
    Properties: None
    Impact: Granular tactic specification
    Implementation: Split Technique nodes, add hierarchy
    Expected Count: ~200-300 SubTechniques

Priority 5 - Advanced Relationships (üü¢ LOW):
-----------------------------------------------
AttackTechnique ‚îÄ[REQUIRES]‚Üí AttackTechnique
    Status: ‚ùå NOT IMPLEMENTED
    MITRE ATT&CK: üîµ Extension (prerequisite modeling)
    Properties: prerequisite_type
    Impact: Attack sequence modeling
    Implementation: Custom analysis of technique descriptions
    Expected Count: ~50-100 relationships

CWE ‚îÄ[CHILD_OF]‚Üí CWE
    Status: ‚úÖ IMPLEMENTED (from import_cwe_hierarchy.py)
    MITRE CWE: ‚úÖ Native
    Properties: None
    Impact: Weakness taxonomy navigation
    Coverage: 100% (from CWE XML)


RELATIONSHIP SEMANTIC ISSUES
================================================================================

Issue 1: USES_TECHNIQUE vs IMPLEMENTS (CAPEC ‚Üí AttackTechnique)
----------------------------------------------------------------
Current State:
  - create_capec_relationships.py uses [:USES_TECHNIQUE]
  - import_capec_attack_relationships.py uses [:IMPLEMENTS]
  - Both relationship types exist in database

Recommendation:
  - Standardize on [:IMPLEMENTS] (aligns with MITRE semantics)
  - CAPEC "implements" a technique (design pattern)
  - Groups/Software "use" techniques (operational usage)

Migration:
  1. Create parallel [:IMPLEMENTS] relationships
  2. Update queries to support both: [:IMPLEMENTS|USES_TECHNIQUE]
  3. After verification, deprecate [:USES_TECHNIQUE]

Impact: MEDIUM - Requires query updates but no data loss

Issue 2: ENABLES_ATTACK_PATTERN vs ENABLES
--------------------------------------------
Current State:
  - Verbose relationship name: ENABLES_ATTACK_PATTERN
  - Unambiguous but lengthy

Recommendation:
  - Shorten to [:ENABLES]
  - Context clear from node types (CWE ‚Üí CAPEC)
  - Consistent with document-level [:ENABLES] relationships

Migration:
  1. Create parallel [:ENABLES] relationships
  2. Update queries gradually
  3. Deprecate [:ENABLES_ATTACK_PATTERN]

Impact: LOW - Non-breaking, cosmetic improvement

Issue 3: Document-level vs Catalog-level Relationship Overlap
--------------------------------------------------------------
Relationships with same name but different contexts:
  - [:EXPLOITS] (document-level: VULNERABILITY ‚Üí CWE)
  - [:EXPLOITS] (potential catalog-level: CVE ‚Üí CWE)

Current State: Separated by node label context (VULNERABILITY vs CVE)

Recommendation:
  - Keep separation via node label context
  - Consider adding relationship property: source_type = "document" | "catalog"
  - Or use distinct names: [:DOCUMENT_EXPLOITS] vs [:EXPLOITS]

Impact: LOW - Currently functional, optimization possible


BI-DIRECTIONAL RELATIONSHIP ANALYSIS
================================================================================

Current: All relationships are UNI-DIRECTIONAL
Performance Impact: 10-40x slower for reverse traversal

High-Value Reverse Relationships:
----------------------------------
CWE ‚îÄ[WEAKNESS_FOR]‚Üí CVE (reverse of IS_WEAKNESS_TYPE)
  Query Pattern: "Find all CVEs for this weakness type"
  Current Performance: 2000ms (full relationship scan)
  With Reverse: 50ms (indexed lookup)
  ROI: 40x speedup
  Implementation Complexity: LOW (simple MERGE)

CAPEC ‚îÄ[EXPLOITS_WEAKNESS]‚Üí CWE (reverse of ENABLES)
  Query Pattern: "Find weaknesses exploited by this attack pattern"
  Current Performance: 500ms
  With Reverse: 30ms
  ROI: 16x speedup
  Implementation Complexity: LOW

AttackTactic ‚îÄ[CONTAINS]‚Üí AttackTechnique (reverse of PART_OF)
  Query Pattern: "List all techniques in this tactic"
  Current Performance: 100ms (relatively low count)
  With Reverse: 20ms
  ROI: 5x speedup (lower priority)
  Implementation Complexity: LOW

Recommendation: Implement selective reverse relationships
  1. High-frequency query patterns only
  2. Maintain parity via validation queries
  3. Monitor storage overhead (minimal, ~2-5% increase)


RELATIONSHIP PROPERTY RECOMMENDATIONS
================================================================================

Temporal Context (HIGH PRIORITY):
----------------------------------
AttackGroup ‚îÄ[USES]‚Üí AttackTechnique
  Add: first_seen: datetime()
       last_seen: datetime()
       frequency: "high" | "medium" | "low"
       campaign: string (reference)
  Impact: Temporal threat analysis

Confidence Scoring (MEDIUM PRIORITY):
--------------------------------------
CVE ‚îÄ[IS_WEAKNESS_TYPE]‚Üí CWE
  Add: confidence: float (0.0-1.0)
       source: "NVD" | "manual" | "inferred"
       extraction_method: "automated" | "verified"
  Impact: Data quality tracking

CAPEC ‚îÄ[IMPLEMENTS]‚Üí AttackTechnique
  Add: mapping_source: "CAPEC XML taxonomy" | "manual"
       confidence: float
  Impact: Relationship provenance

Performance Metrics (LOW PRIORITY):
------------------------------------
Mitigation ‚îÄ[MITIGATES]‚Üí AttackTechnique
  Add: effectiveness: "high" | "medium" | "low"
       implementation_cost: integer (1-5 scale)
       deployment_complexity: integer (1-5 scale)
  Impact: Defensive strategy optimization


SUMMARY STATISTICS
================================================================================

Current Relationship Types: 12
  - Attack chain: 4 (IS_WEAKNESS_TYPE, ENABLES_ATTACK_PATTERN, IMPLEMENTS, PART_OF)
  - ATT&CK native: 3 (USES, IMPLEMENTS, PART_OF)
  - Document processing: 5 (MENTIONED_IN, EXPLOITS, TARGETS, USES, ENABLES, MITIGATES)

Missing Relationship Types: 8
  - High priority: 2 (MITIGATES, DETECTS)
  - Medium priority: 3 (REDUCES_RISK, PROVIDES_VISIBILITY, ATTRIBUTED_TO)
  - Low priority: 3 (SUBTECHNIQUE_OF, REQUIRES, TARGETS)

Semantic Issues: 3
  - USES_TECHNIQUE vs IMPLEMENTS (standardization needed)
  - ENABLES_ATTACK_PATTERN (verbosity reduction)
  - Document vs catalog overlap (optimization possible)

Bi-directional Opportunities: 3
  - WEAKNESS_FOR (40x speedup potential)
  - EXPLOITS_WEAKNESS (16x speedup potential)
  - CONTAINS (5x speedup potential)

Overall Compatibility: 98%
Breaking Changes Required: 0 (all extensions are additive)
================================================================================
