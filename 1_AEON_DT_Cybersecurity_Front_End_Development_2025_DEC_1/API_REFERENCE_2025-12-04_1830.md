# AEON NER11 Gold Model - Complete API Reference

**Document ID**: API_REF_2025-12-04_1830
**Generated**: 2025-12-04 18:30:00 UTC
**Version**: 2.0.0
**Status**: PRODUCTION READY

---

## Table of Contents

1. [Quick Start for Frontend Developers](#quick-start-for-frontend-developers)
2. [Authentication & Headers](#authentication--headers)
3. [Base URLs & Endpoints Summary](#base-urls--endpoints-summary)
4. [E15 Vendor Equipment API](#e15-vendor-equipment-api)
5. [E03 SBOM Analysis API](#e03-sbom-analysis-api)
6. [Customer Semantic Search API](#customer-semantic-search-api)
7. [Data Models Reference](#data-models-reference)
8. [Error Handling](#error-handling)
9. [TypeScript Interfaces](#typescript-interfaces)

---

## Quick Start for Frontend Developers

### 1. Required Setup

```typescript
// Base configuration
const API_BASE = "http://localhost:8000";  // or your production URL

// All requests require customer isolation header
const headers = {
  "Content-Type": "application/json",
  "X-Customer-ID": "your-customer-id",  // REQUIRED
  "X-User-ID": "user@example.com",      // Optional for audit
};
```

### 2. First API Call

```typescript
// Test connectivity with health check
const response = await fetch(`${API_BASE}/api/v2/search/health`);
const health = await response.json();
// Expected: { status: "healthy", qdrant_connected: true, ... }
```

### 3. Sample Requests

```typescript
// Search for vendors
const vendors = await fetch(`${API_BASE}/api/v2/vendor-equipment/vendors/search?query=Cisco`, {
  headers: { "X-Customer-ID": "acme-corp" }
});

// Get SBOM risk summary
const risk = await fetch(`${API_BASE}/api/v2/sbom/sboms/${sbomId}/risk-summary`, {
  headers: { "X-Customer-ID": "acme-corp" }
});

// Semantic search
const results = await fetch(
  `${API_BASE}/api/v2/search/semantic?query=log4j vulnerability&limit=20`,
  { headers: { "X-Customer-ID": "acme-corp" } }
);
```

---

## Authentication & Headers

### Required Headers

| Header | Type | Required | Description |
|--------|------|----------|-------------|
| `X-Customer-ID` | string | **YES** | Customer identifier for multi-tenant isolation |
| `Content-Type` | string | Yes (POST) | `application/json` for POST requests |

### Optional Headers

| Header | Type | Default | Description |
|--------|------|---------|-------------|
| `X-User-ID` | string | null | User identifier for audit trail |
| `X-Namespace` | string | customer_id | Customer namespace for data partitioning |

### Example Headers

```http
GET /api/v2/vendor-equipment/vendors HTTP/1.1
Host: api.aeon-ner11.com
X-Customer-ID: acme-corp
X-User-ID: john.doe@acme.com
```

### Customer Isolation

All data is isolated by `customer_id`. A request with `X-Customer-ID: acme-corp` will:
- Only return data belonging to `acme-corp`
- Include SYSTEM entities (shared CVEs, CWEs, ATT&CK techniques)
- Never return data from other customers

---

## Base URLs & Endpoints Summary

### API Prefixes

| API Module | Base Path | Tag |
|------------|-----------|-----|
| Vendor Equipment | `/api/v2/vendor-equipment` | vendor-equipment |
| SBOM Analysis | `/api/v2/sbom` | sbom-analysis |
| Semantic Search | `/api/v2/search` | semantic-search |

### Complete Endpoint Index

#### E15 Vendor Equipment (28 endpoints)

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/vendors` | Create vendor |
| GET | `/vendors/{vendor_id}` | Get vendor by ID |
| GET | `/vendors/search` | Search vendors |
| GET | `/vendors/high-risk` | Get high-risk vendors |
| GET | `/vendors/{vendor_id}/risk-summary` | Vendor risk summary |
| POST | `/equipment` | Create equipment |
| GET | `/equipment/{model_id}` | Get equipment by ID |
| GET | `/equipment/search` | Search equipment |
| GET | `/equipment/approaching-eol` | Equipment near EOL |
| GET | `/vendors/{vendor_id}/equipment` | Equipment by vendor |
| GET | `/equipment/maintenance-schedule` | Maintenance schedule |
| POST | `/vendors/vulnerability` | Flag vendor vulnerability |
| GET | `/vendors/{vendor_id}/cves` | Get vendor CVEs |
| GET | `/cves/search` | Search CVEs semantically |
| GET | `/cves/critical` | Get critical vulnerabilities |
| POST | `/maintenance-windows` | Create maintenance window |
| GET | `/maintenance-windows` | List maintenance windows |
| GET | `/maintenance-windows/{window_id}` | Get window details |
| PUT | `/maintenance-windows/{window_id}` | Update window |
| DELETE | `/maintenance-windows/{window_id}` | Delete window |
| GET | `/equipment/{model_id}/predictions` | Maintenance predictions |
| POST | `/work-orders` | Create work order |
| GET | `/work-orders` | List work orders |
| GET | `/work-orders/{work_order_id}` | Get work order |
| PUT | `/work-orders/{work_order_id}` | Update work order |
| POST | `/equipment/{model_id}/schedule-maintenance` | Schedule maintenance |
| GET | `/dashboard/supply-chain` | Supply chain dashboard |
| GET | `/health` | Health check |

#### E03 SBOM Analysis (32 endpoints)

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/sboms` | Create SBOM |
| GET | `/sboms/{sbom_id}` | Get SBOM by ID |
| GET | `/sboms` | List/search SBOMs |
| DELETE | `/sboms/{sbom_id}` | Delete SBOM |
| GET | `/sboms/{sbom_id}/risk-summary` | SBOM risk summary |
| POST | `/components` | Create component |
| GET | `/components/{component_id}` | Get component by ID |
| GET | `/components/search` | Semantic component search |
| GET | `/components/vulnerable` | Vulnerable components |
| GET | `/components/high-risk` | High-risk components |
| GET | `/sboms/{sbom_id}/components` | Components by SBOM |
| POST | `/dependencies` | Create dependency |
| GET | `/components/{id}/dependencies` | Dependency tree |
| GET | `/components/{id}/dependents` | Reverse dependencies |
| GET | `/components/{id}/impact` | Impact analysis |
| GET | `/sboms/{sbom_id}/cycles` | Detect cycles |
| GET | `/dependencies/path` | Shortest path |
| GET | `/sboms/{sbom_id}/graph-stats` | Graph statistics |
| POST | `/vulnerabilities` | Create vulnerability |
| GET | `/vulnerabilities/{id}` | Get vulnerability |
| GET | `/vulnerabilities/search` | Semantic vulnerability search |
| GET | `/vulnerabilities/critical` | Critical vulnerabilities |
| GET | `/vulnerabilities/kev` | CISA KEV vulnerabilities |
| GET | `/vulnerabilities/epss-prioritized` | EPSS-prioritized vulns |
| GET | `/vulnerabilities/by-apt` | APT group report |
| GET | `/components/{id}/vulnerabilities` | Vulns by component |
| POST | `/vulnerabilities/{id}/acknowledge` | Acknowledge CVE |
| GET | `/sboms/{sbom_id}/remediation` | Remediation report |
| GET | `/sboms/{sbom_id}/license-compliance` | License compliance |
| GET | `/dashboard/summary` | Customer dashboard |
| GET | `/sboms/{sbom_id}/vulnerable-paths` | Vulnerable paths |
| POST | `/sboms/{sbom_id}/correlate-equipment` | E15 correlation |

#### Semantic Search (5 endpoints)

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | `/semantic` | Semantic search (query params) |
| POST | `/semantic/body` | Semantic search (JSON body) |
| GET | `/labels` | Available NER labels |
| GET | `/collections` | Available collections |
| GET | `/health` | Health check |

---

## E15 Vendor Equipment API

### Create Vendor

```http
POST /api/v2/vendor-equipment/vendors
```

**Request Body:**

```json
{
  "vendor_id": "vendor-001",
  "name": "Cisco Systems",
  "risk_score": 3.5,
  "support_status": "active",
  "country": "USA",
  "industry_focus": ["networking", "security"],
  "supply_chain_tier": 1,
  "website": "https://cisco.com",
  "contact_email": "support@cisco.com"
}
```

**Response:**

```json
{
  "vendor_id": "vendor-001",
  "name": "Cisco Systems",
  "customer_id": "acme-corp",
  "risk_score": 3.5,
  "risk_level": "medium",
  "support_status": "active",
  "country": "USA",
  "industry_focus": ["networking", "security"],
  "supply_chain_tier": 1,
  "total_cves": 0,
  "avg_cvss_score": 0.0
}
```

### Search Vendors

```http
GET /api/v2/vendor-equipment/vendors/search?query=cisco&limit=10
```

**Query Parameters:**

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| query | string | required | Search query |
| limit | int | 10 | Max results (1-100) |
| risk_level | string | null | Filter: low, medium, high, critical |
| support_status | string | null | Filter: active, limited, suspended, terminated |

**Response:**

```json
{
  "total_results": 3,
  "customer_id": "acme-corp",
  "results": [
    {
      "vendor_id": "vendor-001",
      "name": "Cisco Systems",
      "customer_id": "acme-corp",
      "risk_score": 3.5,
      "risk_level": "medium",
      "support_status": "active",
      "country": "USA",
      "industry_focus": ["networking"],
      "supply_chain_tier": 1,
      "total_cves": 12,
      "avg_cvss_score": 6.8
    }
  ]
}
```

### Create Equipment

```http
POST /api/v2/vendor-equipment/equipment
```

**Request Body:**

```json
{
  "model_id": "equip-001",
  "vendor_id": "vendor-001",
  "model_name": "Catalyst 9300",
  "product_line": "Catalyst",
  "release_date": "2020-01-15",
  "eol_date": "2028-01-15",
  "eos_date": "2030-01-15",
  "current_version": "17.6.4",
  "maintenance_schedule": "quarterly",
  "criticality": "high",
  "category": "Switch",
  "description": "Enterprise-class stackable switch"
}
```

### Get Equipment Approaching EOL

```http
GET /api/v2/vendor-equipment/equipment/approaching-eol?days=365
```

**Query Parameters:**

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| days | int | 180 | Days until EOL threshold |
| limit | int | 50 | Max results |

### Vendor Risk Summary

```http
GET /api/v2/vendor-equipment/vendors/{vendor_id}/risk-summary
```

**Response:**

```json
{
  "vendor_id": "vendor-001",
  "vendor_name": "Cisco Systems",
  "total_equipment": 45,
  "total_cves": 127,
  "avg_cvss": 6.2,
  "critical_cves": 8,
  "equipment_at_eol": 3,
  "equipment_approaching_eol": 12,
  "risk_score": 5.8,
  "risk_level": "medium"
}
```

### Maintenance Windows

```http
POST /api/v2/vendor-equipment/maintenance-windows
```

**Request Body:**

```json
{
  "window_id": "mw-001",
  "name": "Q1 Patch Cycle",
  "window_type": "scheduled",
  "start_time": "2025-01-15T02:00:00Z",
  "end_time": "2025-01-15T06:00:00Z",
  "affected_equipment_ids": ["equip-001", "equip-002"],
  "recurrence_pattern": "0 2 15 1,4,7,10 *",
  "notes": "Quarterly firmware updates"
}
```

### Work Orders

```http
POST /api/v2/vendor-equipment/work-orders
```

**Request Body:**

```json
{
  "work_order_id": "wo-001",
  "title": "Firmware Update - Catalyst 9300",
  "equipment_id": "equip-001",
  "priority": "high",
  "scheduled_start": "2025-01-15T02:00:00Z",
  "estimated_duration_hours": 2,
  "assigned_to": "network-team",
  "maintenance_type": "firmware_update",
  "description": "Update to version 17.9.1"
}
```

---

## E03 SBOM Analysis API

### Create SBOM

```http
POST /api/v2/sbom/sboms
```

**Request Body:**

```json
{
  "sbom_id": "sbom-001",
  "name": "Production Application SBOM",
  "format": "cyclonedx",
  "format_version": "1.4",
  "target_system_id": "sys-001",
  "target_system_name": "Production Web Server",
  "tool_name": "syft",
  "tool_version": "0.95.0",
  "serial_number": "urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79"
}
```

### Create Component

```http
POST /api/v2/sbom/components
```

**Request Body:**

```json
{
  "component_id": "comp-001",
  "sbom_id": "sbom-001",
  "name": "lodash",
  "version": "4.17.21",
  "component_type": "library",
  "purl": "pkg:npm/lodash@4.17.21",
  "cpe": "cpe:2.3:a:lodash:lodash:4.17.21:*:*:*:*:*:*:*",
  "supplier": "Lodash Maintainers",
  "publisher": "npm",
  "group": null,
  "license_type": "mit",
  "license_expression": "MIT",
  "description": "A modern JavaScript utility library"
}
```

### Create Vulnerability

```http
POST /api/v2/sbom/vulnerabilities
```

**Request Body:**

```json
{
  "vulnerability_id": "vuln-001",
  "cve_id": "CVE-2024-12345",
  "component_id": "comp-001",
  "title": "Prototype Pollution in lodash",
  "description": "A prototype pollution vulnerability exists...",
  "cvss_v3_score": 7.5,
  "cvss_v3_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "epss_score": 0.045,
  "epss_percentile": 85.2,
  "exploit_available": true,
  "in_the_wild": false,
  "cisa_kev": false,
  "apt_groups": ["APT28"],
  "fixed_version": "4.17.22",
  "patch_url": "https://github.com/lodash/lodash/releases/tag/4.17.22"
}
```

### SBOM Risk Summary

```http
GET /api/v2/sbom/sboms/{sbom_id}/risk-summary
```

**Response:**

```json
{
  "sbom_id": "sbom-001",
  "sbom_name": "Production Application SBOM",
  "total_components": 245,
  "vulnerable_components": 18,
  "critical_vulns": 2,
  "high_vulns": 8,
  "max_cvss": 9.8,
  "avg_cvss": 6.4,
  "license_risk_high_count": 5,
  "copyleft_count": 12,
  "remediation_available": 14,
  "kev_count": 1,
  "exploitable_count": 6
}
```

### Semantic Component Search

```http
GET /api/v2/sbom/components/search?query=logging library&limit=20
```

**Query Parameters:**

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| query | string | required | Natural language search |
| limit | int | 10 | Max results (1-100) |
| component_type | string | null | Filter: library, framework, application, etc. |
| license_risk | string | null | Filter: low, medium, high, critical |
| min_cvss | float | null | Minimum CVSS score |

### EPSS-Prioritized Vulnerabilities

```http
GET /api/v2/sbom/vulnerabilities/epss-prioritized?limit=20
```

**Response:**

```json
{
  "total_results": 45,
  "customer_id": "acme-corp",
  "results": [
    {
      "vulnerability_id": "vuln-003",
      "cve_id": "CVE-2024-99999",
      "component_id": "comp-012",
      "title": "Remote Code Execution",
      "cvss_v3_score": 8.5,
      "severity": "high",
      "epss_score": 0.92,
      "epss_percentile": 99.8,
      "in_the_wild": true,
      "cisa_kev": true,
      "fixed_version": "2.0.1"
    }
  ]
}
```

### Dependency Graph Statistics

```http
GET /api/v2/sbom/sboms/{sbom_id}/graph-stats
```

**Response:**

```json
{
  "total_components": 245,
  "total_dependencies": 512,
  "direct_dependencies": 45,
  "transitive_dependencies": 467,
  "max_depth": 8,
  "avg_depth": 3.2,
  "root_nodes": 1,
  "leaf_nodes": 89,
  "cyclic_dependencies": 0,
  "graph_density": 0.0086
}
```

### Impact Analysis

```http
GET /api/v2/sbom/components/{component_id}/impact
```

**Response:**

```json
{
  "component_id": "comp-001",
  "component_name": "lodash",
  "direct_dependents": 12,
  "transitive_dependents": 45,
  "vulnerability_exposure": 3,
  "sboms_affected": ["sbom-001", "sbom-002"],
  "max_cvss_propagated": 7.5,
  "remediation_urgency": "high"
}
```

### APT Vulnerability Report

```http
GET /api/v2/sbom/vulnerabilities/by-apt?apt_group=APT28
```

**Response:**

```json
{
  "apt_group": "APT28",
  "total_vulnerabilities": 8,
  "customer_id": "acme-corp",
  "vulnerabilities": [
    {
      "cve_id": "CVE-2024-12345",
      "cvss_v3_score": 9.8,
      "component_name": "log4j",
      "component_version": "2.14.0",
      "exploit_available": true,
      "in_the_wild": true
    }
  ]
}
```

### License Compliance

```http
GET /api/v2/sbom/sboms/{sbom_id}/license-compliance
```

**Response:**

```json
{
  "sbom_id": "sbom-001",
  "is_compliant": false,
  "compliant_count": 230,
  "non_compliant_count": 15,
  "license_distribution": {
    "MIT": 120,
    "Apache-2.0": 85,
    "GPL-3.0": 12,
    "BSD-3-Clause": 25,
    "UNKNOWN": 3
  },
  "copyleft_violations": ["comp-045", "comp-067"],
  "license_conflicts": [
    {
      "component_a": "comp-023",
      "license_a": "GPL-3.0",
      "component_b": "comp-089",
      "license_b": "Apache-2.0",
      "conflict_type": "copyleft_incompatible"
    }
  ],
  "high_risk_licenses": 12,
  "recommendations": [
    "Replace GPL-3.0 licensed components in proprietary distribution",
    "Review UNKNOWN license components for compliance"
  ]
}
```

---

## Customer Semantic Search API

### Semantic Search (Query Parameters)

```http
POST /api/v2/search/semantic?query=ransomware&limit=20
```

**Query Parameters:**

| Parameter | Type | Default | Description |
|-----------|------|---------|-------------|
| query | string | required | Natural language query |
| limit | int | 10 | Max results (1-100) |
| label_filter | string | null | Tier 1 NER label (60 types) |
| fine_grained_filter | string | null | Tier 2 type (566 types) |
| confidence_threshold | float | 0.0 | Minimum confidence (0-1) |

**Response:**

```json
{
  "query": "ransomware",
  "total_results": 15,
  "customer_id": "acme-corp",
  "results": [
    {
      "entity_id": "ent-001",
      "text": "WannaCry Ransomware",
      "label": "MALWARE",
      "fine_grained_type": "RANSOMWARE",
      "confidence": 0.95,
      "source_document": "threat_report_2024.pdf",
      "metadata": {
        "first_seen": "2017-05-12",
        "attribution": "Lazarus Group"
      }
    }
  ],
  "execution_time_ms": 45
}
```

### Semantic Search (JSON Body)

```http
POST /api/v2/search/semantic/body
Content-Type: application/json
```

**Request Body:**

```json
{
  "query": "critical infrastructure attack",
  "customer_id": "acme-corp",
  "limit": 25,
  "label_filter": "ATTACK_PATTERN",
  "fine_grained_filter": null,
  "confidence_threshold": 0.7,
  "include_system": true,
  "namespace": "acme_corp"
}
```

### Available Labels

```http
GET /api/v2/search/labels
```

**Response:**

```json
{
  "tier_1_labels": [
    "VULNERABILITY", "MALWARE", "ATTACK_PATTERN", "THREAT_ACTOR",
    "TOOL", "CAMPAIGN", "COURSE_OF_ACTION", "INDICATOR",
    "SOFTWARE", "HARDWARE", "PROTOCOL", "CONFIGURATION",
    ...
  ],
  "tier_2_types": {
    "VULNERABILITY": ["CVE", "CWE", "CAPEC", "ZERO_DAY"],
    "MALWARE": ["RANSOMWARE", "TROJAN", "WORM", "SPYWARE", "ROOTKIT"],
    ...
  }
}
```

---

## Data Models Reference

### Enums

#### VendorRiskLevel
```
low | medium | high | critical
```

#### LifecycleStatus
```
active | approaching_eol | at_eol | past_eol | approaching_eos | past_eos | unknown
```

#### SupportStatus
```
active | limited | suspended | terminated | unknown
```

#### ComponentType
```
application | library | framework | container | operating_system | firmware | file | device | machine_learning | data
```

#### LicenseType
```
mit | apache_2 | gpl_2 | gpl_3 | lgpl_2_1 | lgpl_3 | bsd_2 | bsd_3 | mpl_2 | epl_2 | agpl_3 | cc0 | unlicense | proprietary | unknown
```

#### LicenseRisk
```
low | medium | high | critical
```

#### VulnerabilitySeverity
```
none | low | medium | high | critical
```

#### ExploitMaturity
```
unproven | proof_of_concept | functional | weaponized
```

#### SBOMFormat
```
cyclonedx | spdx | swid | syft | custom
```

---

## Error Handling

### Error Response Format

```json
{
  "detail": "Error message here",
  "status_code": 400
}
```

### Common Error Codes

| Code | Meaning | Common Causes |
|------|---------|---------------|
| 400 | Bad Request | Missing X-Customer-ID, invalid parameters |
| 404 | Not Found | Resource doesn't exist or belongs to another customer |
| 422 | Validation Error | Invalid enum value, missing required field |
| 500 | Server Error | Database connection, internal processing error |

### Example Error Responses

**Missing Customer ID:**
```json
{
  "detail": "X-Customer-ID header is required",
  "status_code": 400
}
```

**Resource Not Found:**
```json
{
  "detail": "Vendor vendor-999 not found",
  "status_code": 404
}
```

**Validation Error:**
```json
{
  "detail": [
    {
      "loc": ["body", "risk_score"],
      "msg": "ensure this value is less than or equal to 10",
      "type": "value_error.number.not_le"
    }
  ],
  "status_code": 422
}
```

---

## TypeScript Interfaces

```typescript
// ============================================================
// AEON NER11 Gold Model - TypeScript Interfaces
// Generated: 2025-12-04 18:30:00 UTC
// ============================================================

// === Vendor Equipment Types ===

interface Vendor {
  vendor_id: string;
  name: string;
  customer_id: string;
  risk_score: number;
  risk_level: 'low' | 'medium' | 'high' | 'critical';
  support_status: 'active' | 'limited' | 'suspended' | 'terminated' | 'unknown';
  country?: string;
  industry_focus: string[];
  supply_chain_tier: 1 | 2 | 3;
  total_cves: number;
  avg_cvss_score: number;
}

interface Equipment {
  model_id: string;
  vendor_id: string;
  model_name: string;
  customer_id: string;
  product_line?: string;
  eol_date?: string;  // ISO date
  eos_date?: string;  // ISO date
  lifecycle_status: 'active' | 'approaching_eol' | 'at_eol' | 'past_eol' |
                   'approaching_eos' | 'past_eos' | 'unknown';
  criticality: 'low' | 'medium' | 'high' | 'critical';
  category?: string;
  days_to_eol?: number;
  days_to_eos?: number;
}

interface VendorSearchResponse {
  total_results: number;
  customer_id: string;
  results: Vendor[];
}

interface VendorRiskSummary {
  vendor_id: string;
  vendor_name: string;
  total_equipment: number;
  total_cves: number;
  avg_cvss: number;
  critical_cves: number;
  equipment_at_eol: number;
  equipment_approaching_eol: number;
  risk_score: number;
  risk_level: string;
}

// === SBOM Types ===

interface SBOM {
  sbom_id: string;
  name: string;
  customer_id: string;
  format: 'cyclonedx' | 'spdx' | 'swid' | 'syft' | 'custom';
  format_version?: string;
  target_system_id?: string;
  target_system_name?: string;
  total_components: number;
  direct_dependencies: number;
  transitive_dependencies: number;
  total_vulnerabilities: number;
  critical_count: number;
  high_count: number;
  medium_count: number;
  low_count: number;
  generated_at?: string;  // ISO datetime
}

interface SoftwareComponent {
  component_id: string;
  sbom_id: string;
  customer_id: string;
  name: string;
  version: string;
  component_type: 'application' | 'library' | 'framework' | 'container' |
                  'operating_system' | 'firmware' | 'file' | 'device' |
                  'machine_learning' | 'data';
  purl?: string;
  cpe?: string;
  supplier?: string;
  license_type?: string;
  license_risk?: 'low' | 'medium' | 'high' | 'critical';
  status: 'active' | 'deprecated' | 'vulnerable' | 'eol';
  vulnerability_count: number;
  critical_vuln_count: number;
  max_cvss_score: number;
  is_high_risk: boolean;
}

interface SoftwareVulnerability {
  vulnerability_id: string;
  cve_id: string;
  component_id: string;
  title?: string;
  description?: string;
  cvss_v3_score: number;
  cvss_v3_vector?: string;
  severity: 'none' | 'low' | 'medium' | 'high' | 'critical';
  epss_score?: number;
  epss_percentile?: number;
  exploit_available: boolean;
  in_the_wild: boolean;
  cisa_kev: boolean;
  apt_groups: string[];
  fixed_version?: string;
  patch_url?: string;
}

interface SBOMRiskSummary {
  sbom_id: string;
  sbom_name: string;
  total_components: number;
  vulnerable_components: number;
  critical_vulns: number;
  high_vulns: number;
  max_cvss: number;
  avg_cvss: number;
  license_risk_high_count: number;
  copyleft_count: number;
  remediation_available: number;
  kev_count: number;
  exploitable_count: number;
}

interface DependencyGraphStats {
  total_components: number;
  total_dependencies: number;
  direct_dependencies: number;
  transitive_dependencies: number;
  max_depth: number;
  avg_depth: number;
  root_nodes: number;
  leaf_nodes: number;
  cyclic_dependencies: number;
  graph_density: number;
}

interface ImpactAnalysis {
  component_id: string;
  component_name: string;
  direct_dependents: number;
  transitive_dependents: number;
  vulnerability_exposure: number;
  sboms_affected: string[];
  max_cvss_propagated: number;
  remediation_urgency: 'low' | 'medium' | 'high' | 'critical';
}

// === Semantic Search Types ===

interface SemanticSearchResult {
  entity_id: string;
  text: string;
  label: string;
  fine_grained_type?: string;
  confidence: number;
  source_document?: string;
  metadata?: Record<string, any>;
}

interface SemanticSearchResponse {
  query: string;
  total_results: number;
  customer_id: string;
  results: SemanticSearchResult[];
  execution_time_ms: number;
}

// === API Client ===

class AEONApiClient {
  private baseUrl: string;
  private customerId: string;
  private userId?: string;

  constructor(baseUrl: string, customerId: string, userId?: string) {
    this.baseUrl = baseUrl;
    this.customerId = customerId;
    this.userId = userId;
  }

  private get headers(): HeadersInit {
    return {
      'Content-Type': 'application/json',
      'X-Customer-ID': this.customerId,
      ...(this.userId && { 'X-User-ID': this.userId }),
    };
  }

  // Vendor Equipment
  async searchVendors(query: string, limit = 10): Promise<VendorSearchResponse> {
    const res = await fetch(
      `${this.baseUrl}/api/v2/vendor-equipment/vendors/search?query=${encodeURIComponent(query)}&limit=${limit}`,
      { headers: this.headers }
    );
    return res.json();
  }

  async getVendorRiskSummary(vendorId: string): Promise<VendorRiskSummary> {
    const res = await fetch(
      `${this.baseUrl}/api/v2/vendor-equipment/vendors/${vendorId}/risk-summary`,
      { headers: this.headers }
    );
    return res.json();
  }

  // SBOM
  async getSBOMRiskSummary(sbomId: string): Promise<SBOMRiskSummary> {
    const res = await fetch(
      `${this.baseUrl}/api/v2/sbom/sboms/${sbomId}/risk-summary`,
      { headers: this.headers }
    );
    return res.json();
  }

  async getGraphStats(sbomId: string): Promise<DependencyGraphStats> {
    const res = await fetch(
      `${this.baseUrl}/api/v2/sbom/sboms/${sbomId}/graph-stats`,
      { headers: this.headers }
    );
    return res.json();
  }

  // Semantic Search
  async semanticSearch(query: string, limit = 10): Promise<SemanticSearchResponse> {
    const res = await fetch(
      `${this.baseUrl}/api/v2/search/semantic?query=${encodeURIComponent(query)}&limit=${limit}`,
      { method: 'POST', headers: this.headers }
    );
    return res.json();
  }
}

export {
  Vendor, Equipment, VendorSearchResponse, VendorRiskSummary,
  SBOM, SoftwareComponent, SoftwareVulnerability, SBOMRiskSummary,
  DependencyGraphStats, ImpactAnalysis,
  SemanticSearchResult, SemanticSearchResponse,
  AEONApiClient
};
```

---

## Appendix: Version History

| Date | Version | Changes |
|------|---------|---------|
| 2025-12-04 18:30 | 2.0.0 | Initial comprehensive API reference |
| 2025-12-04 | 1.5.0 | E03 SBOM Day 6 integration tests |
| 2025-12-04 | 1.4.0 | E03 SBOM FastAPI endpoints |
| 2025-12-04 | 1.3.0 | E15 Vendor Equipment Day 4 CVE |

---

**Document Generated**: 2025-12-04 18:30:00 UTC
**For Frontend Development Team**
**AEON Digital Twin Cybersecurity Platform**
