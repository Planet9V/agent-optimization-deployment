{
  "metadata": {
    "sector": "WATER",
    "extraction_timestamp": "2025-11-21",
    "database": "openspg-neo4j",
    "extraction_method": "cypher-shell queries",
    "note": "Complete schema patterns extracted from Water sector nodes"
  },
  "node_summary": {
    "total_nodes": 27200,
    "validation_status": "CONFIRMED",
    "expected_range": "~26,000",
    "actual_count": 27200,
    "variance_from_expected": "+1200 nodes (4.6% above expected)"
  },
  "node_type_breakdown": {
    "primary_types": {
      "Measurement": {
        "count": 19000,
        "percentage": 69.85,
        "description": "Monitoring and measurement data points",
        "common_labels": [
          "Measurement",
          "Monitoring",
          "WATER",
          "Water_Treatment",
          "Property",
          "WaterProperty"
        ]
      },
      "Property": {
        "count": 4500,
        "percentage": 16.54,
        "description": "Water properties and attributes",
        "common_labels": [
          "Property",
          "WaterProperty",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ]
      },
      "Device": {
        "count": 1450,
        "percentage": 5.33,
        "description": "Physical devices and equipment",
        "common_labels": [
          "Device",
          "WaterDevice",
          "Property",
          "Measurement"
        ]
      },
      "Process": {
        "count": 874,
        "percentage": 3.21,
        "description": "Treatment and operational processes",
        "common_labels": [
          "Process",
          "TreatmentProcess",
          "WATER",
          "Water_Treatment"
        ]
      },
      "Control": {
        "count": 676,
        "percentage": 2.49,
        "description": "Control systems and SCADA",
        "common_labels": [
          "Control",
          "Device",
          "SCADASystem",
          "WATER",
          "Water_Distribution"
        ]
      },
      "WaterAlert": {
        "count": 500,
        "percentage": 1.84,
        "description": "Alert and notification nodes",
        "common_labels": [
          "WaterAlert",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ]
      },
      "WaterZone": {
        "count": 200,
        "percentage": 0.74,
        "description": "Zone and area definitions",
        "common_labels": [
          "WaterZone",
          "Asset",
          "WATER",
          "Water_Distribution"
        ]
      }
    },
    "total_accounted": 27200,
    "coverage": "100%"
  },
  "label_patterns": {
    "most_common_combinations": [
      {
        "rank": 1,
        "labels": [
          "Measurement",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ],
        "count": 19000,
        "percentage": 69.85,
        "pattern_type": "Core Monitoring",
        "label_count": 4
      },
      {
        "rank": 2,
        "labels": [
          "Property",
          "WaterProperty",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ],
        "count": 2250,
        "percentage": 8.27,
        "pattern_type": "Water Properties",
        "label_count": 5
      },
      {
        "rank": 3,
        "labels": [
          "Property",
          "Measurement",
          "SAREF",
          "Monitoring",
          "SAREF_Core",
          "WATER",
          "Water_Treatment"
        ],
        "count": 1500,
        "percentage": 5.51,
        "pattern_type": "SAREF Standard Properties",
        "label_count": 7
      },
      {
        "rank": 4,
        "labels": [
          "Property",
          "WaterProperty",
          "Monitoring",
          "WATER",
          "Water_Distribution"
        ],
        "count": 750,
        "percentage": 2.75,
        "pattern_type": "Distribution Properties",
        "label_count": 5
      },
      {
        "rank": 5,
        "labels": [
          "Device",
          "Property",
          "Measurement",
          "HealthMetric",
          "Health_Monitor",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ],
        "count": 500,
        "percentage": 1.84,
        "pattern_type": "Health Monitoring Devices",
        "label_count": 8
      },
      {
        "rank": 6,
        "labels": [
          "Process",
          "TreatmentProcess",
          "WATER",
          "Water_Treatment"
        ],
        "count": 500,
        "percentage": 1.84,
        "pattern_type": "Treatment Processes",
        "label_count": 4
      },
      {
        "rank": 7,
        "labels": [
          "WaterAlert",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ],
        "count": 500,
        "percentage": 1.84,
        "pattern_type": "Alerts",
        "label_count": 4
      },
      {
        "rank": 8,
        "labels": [
          "Control",
          "Device",
          "WaterDevice",
          "WATER",
          "Water_Distribution"
        ],
        "count": 376,
        "percentage": 1.38,
        "pattern_type": "Distribution Control",
        "label_count": 5
      },
      {
        "rank": 9,
        "labels": [
          "Device",
          "WaterDevice",
          "Monitoring",
          "WATER",
          "Water_Treatment"
        ],
        "count": 375,
        "percentage": 1.38,
        "pattern_type": "Treatment Devices",
        "label_count": 5
      },
      {
        "rank": 10,
        "labels": [
          "Process",
          "Device",
          "WaterDevice",
          "WATER",
          "Water_Treatment"
        ],
        "count": 374,
        "percentage": 1.37,
        "pattern_type": "Process Equipment",
        "label_count": 5
      }
    ],
    "label_category_distribution": {
      "entity_types": {
        "Device": 1450,
        "Process": 874,
        "Control": 676,
        "Measurement": 19000,
        "Property": 4500,
        "WaterAlert": 500,
        "WaterZone": 200,
        "WaterDevice": 1325,
        "TreatmentProcess": 500,
        "SCADASystem": 300,
        "HealthMetric": 500
      },
      "ontology_standards": {
        "SAREF": 1500,
        "SAREF_Core": 1500,
        "Health_Monitor": 500
      },
      "application_domains": {
        "Monitoring": 25699,
        "Agriculture": 200
      }
    }
  },
  "relationship_types": {
    "total_relationships": 881338,
    "relationship_breakdown": [
      {
        "type": "VULNERABLE_TO",
        "count": 852485,
        "percentage": 96.73,
        "description": "Security vulnerability relationships",
        "source_type": "Device/Process/Control/Measurement",
        "target_type": "Security entities",
        "cardinality": "many-to-many"
      },
      {
        "type": "HAS_MEASUREMENT",
        "count": 18000,
        "percentage": 2.04,
        "description": "Device has measurement data",
        "source_type": "Device/Process/Control",
        "target_type": "Measurement",
        "cardinality": "one-to-many"
      },
      {
        "type": "HAS_PROPERTY",
        "count": 4500,
        "percentage": 0.51,
        "description": "Entity has properties",
        "source_type": "Device/Process/Control/Measurement",
        "target_type": "Property",
        "cardinality": "one-to-many"
      },
      {
        "type": "CONTROLS",
        "count": 3000,
        "percentage": 0.34,
        "description": "Control device controls entity",
        "source_type": "Control",
        "target_type": "Device/Process",
        "cardinality": "one-to-many"
      },
      {
        "type": "CONTAINS",
        "count": 2500,
        "percentage": 0.28,
        "description": "Zone or system contains entity",
        "source_type": "WaterZone/Process",
        "target_type": "Device/Measurement",
        "cardinality": "one-to-many"
      },
      {
        "type": "USES_DEVICE",
        "count": 2000,
        "percentage": 0.23,
        "description": "Process uses device",
        "source_type": "Process",
        "target_type": "Device",
        "cardinality": "one-to-many"
      },
      {
        "type": "EXTENDS_SAREF_DEVICE",
        "count": 1500,
        "percentage": 0.17,
        "description": "SAREF ontology extension",
        "source_type": "Device",
        "target_type": "SAREF entity",
        "cardinality": "one-to-one"
      },
      {
        "type": "DEPENDS_ON_ENERGY",
        "count": 1000,
        "percentage": 0.11,
        "description": "Device depends on energy source",
        "source_type": "Device/Control",
        "target_type": "Energy entity",
        "cardinality": "one-to-many"
      },
      {
        "type": "TRIGGERED_BY",
        "count": 1000,
        "percentage": 0.11,
        "description": "Alert triggered by measurement",
        "source_type": "WaterAlert",
        "target_type": "Measurement/Property",
        "cardinality": "one-to-many"
      }
    ],
    "relationship_patterns": {
      "dominant_pattern": "VULNERABLE_TO (96.73% of all relationships)",
      "pattern_summary": "Security relationships dominate the graph structure, indicating focus on vulnerability tracking",
      "functional_relationships": 31500,
      "functional_percentage": 3.27,
      "functional_pattern": "HAS_MEASUREMENT, HAS_PROPERTY, CONTROLS, CONTAINS define operational structure"
    }
  },
  "multi_label_statistics": {
    "label_distribution_by_node_count": {
      "4_labels": {
        "count": 20500,
        "percentage": 75.37,
        "description": "Core nodes with sector + type + function + monitoring"
      },
      "5_labels": {
        "count": 4500,
        "percentage": 16.54,
        "description": "Enhanced nodes with additional property or ontology labels"
      },
      "7_labels": {
        "count": 1700,
        "percentage": 6.25,
        "description": "Complex nodes with SAREF standard compliance"
      },
      "8_labels": {
        "count": 500,
        "percentage": 1.84,
        "description": "Health monitoring nodes with maximum label complexity"
      }
    },
    "label_statistics": {
      "minimum_labels_per_node": 4,
      "maximum_labels_per_node": 8,
      "average_labels_per_node": 4.32,
      "median_labels_per_node": 4,
      "mode_labels_per_node": 4,
      "total_label_assignments": 117536,
      "unique_label_names": 24
    }
  },
  "subsector_distribution": {
    "Water_Treatment": {
      "count": 25199,
      "percentage": 92.64,
      "description": "Water treatment plants and processes",
      "dominant_types": [
        "Measurement (19000)",
        "Property (2250)",
        "Device (1500)",
        "Process (500)",
        "WaterAlert (500)"
      ]
    },
    "Water_Distribution": {
      "count": 2001,
      "percentage": 7.36,
      "description": "Water distribution networks and infrastructure",
      "dominant_types": [
        "Property (750)",
        "Control (376)",
        "Device (188)",
        "WaterZone (200)",
        "Other (487)"
      ]
    }
  },
  "ontology_integration": {
    "SAREF_compliance": {
      "nodes_with_SAREF": 1500,
      "percentage_of_total": 5.51,
      "pattern": "Property + Measurement + SAREF + Monitoring + SAREF_Core",
      "integration_method": "Multi-label approach with EXTENDS_SAREF_DEVICE relationships"
    },
    "Water_specific_ontologies": {
      "WaterProperty": 3000,
      "WaterDevice": 1325,
      "TreatmentProcess": 500,
      "WaterAlert": 500,
      "WaterZone": 200
    },
    "monitoring_framework": {
      "total_monitoring_nodes": 25699,
      "percentage_of_total": 94.47,
      "key_label": "Monitoring"
    }
  },
  "schema_governance_insights": {
    "core_pattern": "Multi-label hierarchical classification",
    "pattern_structure": [
      "Level 1: Sector (WATER)",
      "Level 2: Subsector (Water_Treatment | Water_Distribution)",
      "Level 3: Entity Type (Device | Process | Control | Measurement | Property | Alert | Zone | Asset)",
      "Level 4: Specific Role (WaterDevice | TreatmentProcess | SCADASystem | WaterProperty | etc.)",
      "Level 5: Optional Standards (SAREF | SAREF_Core | Health_Monitor)"
    ],
    "key_findings": {
      "measurement_dominance": "Measurement nodes represent 69.85% of all nodes, indicating heavy monitoring focus",
      "property_heavy": "Properties (both WaterProperty and generic Property) account for 16.54%, supporting rich semantic descriptions",
      "distribution_minor": "Water_Distribution subsector is only 7.36% of nodes, concentrated in Distribution control",
      "saref_adoption": "SAREF ontology adoption at 5.51% shows selective standards integration",
      "security_focus": "VULNERABLE_TO relationships (96.73%) indicate comprehensive security tracking"
    },
    "label_governance_rules": {
      "mandatory_labels": [
        "WATER (sector identifier)",
        "Water_Treatment | Water_Distribution (subsector)",
        "Entity type label"
      ],
      "optional_labels": [
        "SAREF family (for standard compliance)",
        "Domain labels (Monitoring, Agriculture)",
        "Role refinement labels"
      ],
      "label_cardinality": "4-8 labels per node, with 75% at 4 labels"
    },
    "relationship_governance": {
      "primary_relationships": [
        "HAS_MEASUREMENT (device-to-measurement connection)",
        "HAS_PROPERTY (entity-to-property connection)",
        "CONTROLS (control-to-device connection)"
      ],
      "secondary_relationships": [
        "CONTAINS (zone-to-entity)",
        "USES_DEVICE (process-to-device)",
        "TRIGGERED_BY (alert-to-source)"
      ],
      "security_tracking": [
        "VULNERABLE_TO (comprehensive vulnerability mapping)"
      ]
    }
  },
  "pattern_summary": {
    "node_patterns_identified": 15,
    "core_patterns": [
      {
        "name": "Core Measurement Pattern",
        "labels": "Measurement + Monitoring + WATER + Water_Treatment",
        "count": 19000,
        "purpose": "Baseline monitoring data collection"
      },
      {
        "name": "Enhanced Property Pattern",
        "labels": "Property + WaterProperty + Monitoring + WATER + Water_Treatment/Distribution",
        "count": 3000,
        "purpose": "Rich semantic property descriptions"
      },
      {
        "name": "SAREF Standard Pattern",
        "labels": "Property + Measurement + SAREF + Monitoring + SAREF_Core + WATER + Water_Treatment",
        "count": 1500,
        "purpose": "Semantic interoperability with SAREF"
      },
      {
        "name": "Device Pattern",
        "labels": "Device + WaterDevice + Monitoring/Property + WATER + Subsector",
        "count": 1450,
        "purpose": "Physical water equipment tracking"
      },
      {
        "name": "Health Monitoring Pattern",
        "labels": "Device + Property + Measurement + HealthMetric + Health_Monitor + Monitoring + WATER + Water_Treatment",
        "count": 500,
        "purpose": "System health status tracking"
      },
      {
        "name": "Treatment Process Pattern",
        "labels": "Process + TreatmentProcess + WATER + Water_Treatment",
        "count": 500,
        "purpose": "Treatment operation modeling"
      },
      {
        "name": "Alert Pattern",
        "labels": "WaterAlert + Monitoring + WATER + Water_Treatment",
        "count": 500,
        "purpose": "Alarm and notification system"
      },
      {
        "name": "Distribution Control Pattern",
        "labels": "Control + Device/SCADASystem + WATER + Water_Distribution",
        "count": 676,
        "purpose": "Distribution network control"
      },
      {
        "name": "Zone Pattern",
        "labels": "WaterZone + Asset + WATER + Water_Distribution",
        "count": 200,
        "purpose": "Geographical zone organization"
      }
    ]
  },
  "validation_metrics": {
    "data_quality": "HIGH",
    "coverage": "100% of labeled nodes",
    "consistency": "All nodes follow multi-label hierarchy pattern",
    "completeness": "All major patterns accounted for",
    "distribution_alignment": "92.64% Treatment / 7.36% Distribution matches expected water sector split"
  }
}
