{
  "metadata": {
    "version": "1.0.0",
    "created": "2025-11-21",
    "source_sectors": ["Water", "Energy"],
    "analysis_type": "Cross-Sector Schema Governance",
    "purpose": "Define common node, relationship, and labeling patterns for critical infrastructure sectors"
  },
  "common_label_patterns": {
    "description": "Universal label patterns that appear in both Water and Energy sectors",
    "device_pattern": {
      "template": "[Domain][Device Type]",
      "examples_water": [
        "WaterDevice",
        "WaterTreatmentPlant",
        "Pump",
        "Valve",
        "Sensor"
      ],
      "examples_energy": [
        "EnergyDevice",
        "Generator",
        "Transformer",
        "CircuitBreaker",
        "Relay"
      ],
      "label_composition": [
        "NodeType",
        "DeviceCategory",
        "DeviceSubType",
        "Monitoring"
      ],
      "cardinality": "One to many relationships with measurements and properties"
    },
    "measurement_pattern": {
      "template": "[Domain][Measurement Type][Unit]",
      "examples_water": [
        "pH",
        "Turbidity",
        "DissolvedOxygen",
        "FlowRate",
        "Pressure",
        "WaterLevel"
      ],
      "examples_energy": [
        "Voltage",
        "Current",
        "Frequency",
        "PowerFactor",
        "RealPower",
        "ReactivePower"
      ],
      "label_composition": [
        "Measurement",
        "MeasurementDomain",
        "Unit",
        "DataType",
        "Monitoring"
      ],
      "cardinality": "Many measurements per device (typically 5-15 per device)",
      "frequency": "Real-time or near-real-time data collection"
    },
    "property_pattern": {
      "template": "[Domain][Property][Value Type]",
      "examples_water": [
        "ChlorineResidual",
        "TotalSuspendedSolids",
        "BiochemicalOxygenDemand",
        "ChemicalOxygenDemand",
        "ConductivityLevel"
      ],
      "examples_energy": [
        "TotalHarmonicDistortion",
        "ApparentPower",
        "PhaseAngle",
        "ImpedanceLevel",
        "CapacitanceValue"
      ],
      "label_composition": [
        "Property",
        "PropertyDomain",
        "ValueType",
        "Monitoring"
      ],
      "cardinality": "Multiple properties per device (typically 3-8 per device)"
    },
    "common_label_structure": {
      "description": "Universal label template across both sectors",
      "pattern": "[NodeType]:[SectorSpecificType]:[Domain]:[Monitoring]:[SECTOR]:[Subsector]",
      "examples": {
        "water_device": "Device:WaterTreatmentPlant:Infrastructure:Monitoring:WATER:UrbanWater",
        "water_measurement": "Measurement:pH:WaterQuality:Monitoring:WATER:Distribution",
        "energy_device": "Device:Generator:PowerGeneration:Monitoring:ENERGY:Renewables",
        "energy_measurement": "Measurement:Voltage:Transmission:Monitoring:ENERGY:Distribution",
        "water_property": "Property:ChlorineResidual:WaterTreatment:Monitoring:WATER:Treatment",
        "energy_property": "Property:THD:PowerQuality:Monitoring:ENERGY:Transmission"
      },
      "label_components": {
        "1_NodeType": {
          "description": "Core entity type",
          "values": ["Device", "Measurement", "Property", "Vulnerability", "Vendor", "Standard", "Protocol", "Component", "ThreatActor", "Subsystem"]
        },
        "2_SectorSpecificType": {
          "description": "Domain-specific entity categorization",
          "water_values": ["WaterTreatmentPlant", "Pump", "Valve", "Sensor", "Tank", "Turbidity", "pH", "FlowMeter"],
          "energy_values": ["Generator", "Transformer", "CircuitBreaker", "Substation", "Voltage", "Current", "Frequency", "Relay"]
        },
        "3_Domain": {
          "description": "Functional domain",
          "values": ["Infrastructure", "WaterQuality", "WaterTreatment", "Distribution", "Transmission", "PowerGeneration", "PowerQuality", "Control"]
        },
        "4_Monitoring": {
          "description": "Monitoring status flag",
          "values": ["Monitoring", "Legacy", "Decommissioned", "TestBed", "Virtual"]
        },
        "5_SECTOR": {
          "description": "Critical infrastructure sector",
          "values": ["WATER", "ENERGY"]
        },
        "6_Subsector": {
          "description": "Subsector classification",
          "water_values": ["UrbanWater", "Treatment", "Distribution", "WastewaterManagement", "Industrial"],
          "energy_values": ["Generation", "Transmission", "Distribution", "Renewables", "Nuclear"]
        }
      }
    }
  },
  "core_node_types": {
    "description": "Eight core node types present in both sectors",
    "count": 8,
    "types": [
      {
        "name": "Device",
        "definition": "Physical or logical infrastructure component",
        "water_examples": ["WaterTreatmentPlant", "Pump", "Valve", "Tank", "Sensor"],
        "energy_examples": ["Generator", "Transformer", "CircuitBreaker", "Substation", "Relay"],
        "properties": ["ID", "Name", "Status", "Location", "ManufacturerID", "Model"],
        "relationships": ["HAS_MEASUREMENT", "HAS_PROPERTY", "VULNERABLE_TO", "OPERATES_IN", "MANUFACTURED_BY"]
      },
      {
        "name": "Measurement",
        "definition": "Quantifiable metric collected from devices",
        "water_examples": ["pH", "Turbidity", "FlowRate", "Pressure", "WaterLevel"],
        "energy_examples": ["Voltage", "Current", "Frequency", "PowerFactor", "Watts"],
        "properties": ["ID", "Name", "Unit", "DataType", "SamplingRate", "Min", "Max"],
        "relationships": ["MEASURED_BY", "BELONGS_TO_DEVICE", "HAS_TIMESERIES", "THRESHOLD_DEFINED"]
      },
      {
        "name": "Property",
        "definition": "Qualitative or derived attribute of an entity",
        "water_examples": ["ChlorineResidual", "TotalSuspendedSolids", "BiochemicalOxygenDemand"],
        "energy_examples": ["TotalHarmonicDistortion", "ApparentPower", "ImpedanceLevel"],
        "properties": ["ID", "Name", "Type", "Value", "Unit", "Timestamp"],
        "relationships": ["CHARACTERIZES", "BELONGS_TO", "DERIVED_FROM"]
      },
      {
        "name": "Vulnerability",
        "definition": "Known or potential security weakness",
        "common_examples": ["CVE-XXXX-XXXXX", "DefaultCredentials", "UnauthorizedAccess", "WeakAuthentication"],
        "water_examples": ["CVE entries for water control systems"],
        "energy_examples": ["CVE entries for power systems"],
        "properties": ["ID", "CVENumber", "Severity", "Description", "CVSS_Score", "PublishedDate"],
        "relationships": ["AFFECTS", "EXPLOITS", "MITIGATED_BY", "REQUIRES_PATCH"]
      },
      {
        "name": "Vendor",
        "definition": "Equipment or software manufacturer",
        "water_examples": ["Xylem", "Veolia", "SUEZ", "Grundfos", "Endress+Hauser"],
        "energy_examples": ["Siemens", "ABB", "General Electric", "Schneider Electric", "Honeywell"],
        "properties": ["ID", "Name", "Country", "FoundedYear", "SpecialityAreas"],
        "relationships": ["MANUFACTURES", "PRODUCES", "PROVIDES", "SUPPORTS"]
      },
      {
        "name": "Standard",
        "definition": "Regulatory or technical standard",
        "water_examples": ["EPA Method", "AWWA", "SDWA", "Clean Water Act", "ISO 24516"],
        "energy_examples": ["NERC CIP", "IEEE 1686", "IEC 61850", "ISA-62443", "ISO 27001"],
        "properties": ["ID", "Name", "Organization", "PublishedYear", "RevisionLevel"],
        "relationships": ["GOVERNS", "APPLIES_TO", "REQUIRES", "REFERENCES"]
      },
      {
        "name": "Protocol",
        "definition": "Communication protocol or standard",
        "water_examples": ["Modbus", "DNP3", "OPC UA", "BACnet", "M-Bus"],
        "energy_examples": ["Modbus", "DNP3", "IEC 60870-5", "PROFINET", "GOOSE"],
        "properties": ["ID", "Name", "Layer", "SecurityLevel", "Version"],
        "relationships": ["USES", "COMMUNICATES_VIA", "SUPPORTS_SECURITY_LEVEL"]
      },
      {
        "name": "ThreatActor",
        "definition": "Entity that poses a security threat (energy sector only)",
        "water_examples": ["Not explicitly modeled in water patterns"],
        "energy_examples": ["APT-28", "Nation-State", "InsiderThreat", "Hacktivist"],
        "properties": ["ID", "Name", "Type", "Motivation", "CountryOrigin", "CapabilityLevel"],
        "relationships": ["CONDUCTS_ATTACK", "TARGETS", "EXPLOITS_VULNERABILITY"]
      }
    ]
  },
  "common_relationship_types": {
    "description": "Relationship types present in both sectors",
    "universal_relationships": [
      {
        "type": "HAS_MEASUREMENT",
        "from": "Device",
        "to": "Measurement",
        "cardinality": "1..N",
        "description": "Device produces or is associated with measurements",
        "semantics": "A water pump has flow rate, pressure measurements; a generator has voltage, current measurements"
      },
      {
        "type": "HAS_PROPERTY",
        "from": "Device",
        "to": "Property",
        "cardinality": "1..N",
        "description": "Device has associated properties",
        "semantics": "A treatment plant has chlorine residual property; a transformer has THD property"
      },
      {
        "type": "VULNERABLE_TO",
        "from": "Device",
        "to": "Vulnerability",
        "cardinality": "1..N",
        "description": "Device is susceptible to a vulnerability",
        "semantics": "SCADA system vulnerable to CVE-2024-XXXXX; PLC vulnerable to default credentials"
      },
      {
        "type": "MANUFACTURED_BY",
        "from": "Device",
        "to": "Vendor",
        "cardinality": "N..1",
        "description": "Device is manufactured by a specific vendor",
        "semantics": "Pump manufactured by Xylem; Generator manufactured by Siemens"
      },
      {
        "type": "USES_PROTOCOL",
        "from": "Device",
        "to": "Protocol",
        "cardinality": "N..M",
        "description": "Device communicates using a specific protocol",
        "semantics": "Water SCADA uses Modbus; Power system uses IEC 61850"
      },
      {
        "type": "GOVERNED_BY",
        "from": "Device",
        "to": "Standard",
        "cardinality": "N..M",
        "description": "Device must comply with standards",
        "semantics": "Water treatment plant governed by AWWA and EPA; Power system governed by NERC CIP"
      },
      {
        "type": "OPERATES_IN",
        "from": "Device",
        "to": "Subsystem",
        "cardinality": "N..1",
        "description": "Device is part of a subsystem",
        "semantics": "Pump operates in distribution system; Generator operates in transmission system"
      },
      {
        "type": "MEASURED_BY",
        "from": "Measurement",
        "to": "Device",
        "cardinality": "N..1",
        "description": "Measurement is collected from device",
        "semantics": "pH is measured by water quality sensor; Voltage is measured by IED"
      }
    ],
    "sector_specific_relationships": [
      {
        "type": "AFFECTS",
        "from": "Vulnerability",
        "to": "Device",
        "cardinality": "N..M",
        "sector": "Both",
        "description": "Vulnerability impacts device security"
      },
      {
        "type": "EXPLOITS",
        "from": "ThreatActor",
        "to": "Vulnerability",
        "cardinality": "N..M",
        "sector": "Energy",
        "description": "Threat actor exploits specific vulnerabilities"
      },
      {
        "type": "TARGETS",
        "from": "ThreatActor",
        "to": "Device",
        "cardinality": "N..M",
        "sector": "Energy",
        "description": "Threat actor targets specific devices or systems"
      },
      {
        "type": "MITIGATED_BY",
        "from": "Vulnerability",
        "to": "Standard",
        "cardinality": "N..M",
        "sector": "Both",
        "description": "Standard provides mitigation for vulnerability"
      }
    ]
  },
  "multi_label_rules": {
    "description": "Rules for label assignment per node",
    "label_distribution": {
      "minimum_labels": 5,
      "target_labels": "6-7",
      "maximum_labels": 10,
      "reasoning": "Balanced between expressiveness and query performance"
    },
    "mandatory_labels": [
      "NodeType",
      "SectorSpecificType",
      "Monitoring",
      "SECTOR"
    ],
    "conditional_labels": [
      {
        "condition": "If Device",
        "required_labels": ["Status", "Location", "ManufacturerID"]
      },
      {
        "condition": "If Measurement",
        "required_labels": ["Unit", "DataType", "SamplingRate"]
      },
      {
        "condition": "If Vulnerability",
        "required_labels": ["Severity", "CVSS_Score", "PublishedDate"]
      },
      {
        "condition": "If Device in critical infrastructure",
        "required_labels": ["GovernedBy", "SecurityLevel", "OperationalStatus"]
      }
    ],
    "label_assignment_algorithm": {
      "step_1": "Assign NodeType (1 label)",
      "step_2": "Assign SectorSpecificType (1 label)",
      "step_3": "Assign Domain (1 label)",
      "step_4": "Assign Monitoring status (1 label)",
      "step_5": "Assign SECTOR classification (1 label)",
      "step_6": "Assign Subsector (1 label)",
      "step_7": "Assign domain-specific attributes (0-3 labels)"
    },
    "quality_metrics": {
      "coverage": "All nodes must have at minimum 5 labels",
      "consistency": "Same entity type should have similar label counts (+/- 1 label)",
      "performance": "Query performance optimal at 6-7 labels per node"
    }
  },
  "gold_standard_metrics": {
    "description": "Target metrics for sector graph completeness and balance",
    "node_count": {
      "minimum": 26000,
      "target": 30000,
      "maximum": 35000,
      "reasoning": "Sufficient for comprehensive coverage with edge cases"
    },
    "measurement_nodes": {
      "percentage": "60-70%",
      "count_range": "15600-24500",
      "rationale": "Measurements are most frequent entity type in operational systems"
    },
    "property_nodes": {
      "percentage": "15-20%",
      "count_range": "3900-7000",
      "rationale": "Properties characterize devices and measurements"
    },
    "device_nodes": {
      "percentage": "5-15%",
      "count_range": "1300-5250",
      "rationale": "Devices are core infrastructure; fewer in count but critical"
    },
    "vulnerability_nodes": {
      "percentage": "3-8%",
      "count_range": "780-2800",
      "rationale": "Security landscape evolves; includes known and emerging threats"
    },
    "supporting_nodes": {
      "percentage": "2-5%",
      "count_range": "520-1750",
      "rationale": "Vendors, standards, protocols, threat actors"
    },
    "relationship_density": {
      "edges_per_node": "4-8",
      "total_relationships_estimated": "120000-240000",
      "rationale": "Balanced connectivity for efficient querying"
    },
    "coverage_validation": {
      "all_8_node_types_present": true,
      "all_7_core_relationships_present": true,
      "both_sectors_represented": true,
      "vulnerability_coverage": ">80% of known CVEs in domain"
    }
  },
  "naming_conventions": {
    "node_naming": {
      "device_names": {
        "format": "[DeviceType]-[Location]-[Sequence]",
        "examples": [
          "Pump-WaterDistrict-001",
          "WaterTreatmentPlant-Downtown-01",
          "Generator-NuclearPlant-A01",
          "Transformer-Substation-East-01"
        ]
      },
      "measurement_names": {
        "format": "[MeasurementType]-[Device]-[Unit]",
        "examples": [
          "pH-WTP-Downtown-Units",
          "FlowRate-Pump-WD-001-GPM",
          "Voltage-Generator-NP-A01-kV",
          "Current-Transformer-Sub-East-01-Amp"
        ]
      },
      "property_names": {
        "format": "[PropertyType]-[EntityRef]",
        "examples": [
          "ChlorineResidual-WTP-Downtown",
          "TotalHarmonicDistortion-Gen-NP-A01",
          "BiochemicalOxygenDemand-WWTP-West"
        ]
      }
    },
    "label_naming": {
      "water_sector_labels": {
        "case_style": "PascalCase",
        "components": ["Water", "Treatment", "Distribution", "Quality", "Monitoring"],
        "examples": ["WaterTreatmentPlant", "DistributionSystem", "QualityMonitoring"]
      },
      "energy_sector_labels": {
        "case_style": "PascalCase",
        "components": ["Power", "Generation", "Transmission", "Distribution", "Protection"],
        "examples": ["PowerGeneration", "TransmissionLine", "ProtectiveRelay"]
      }
    },
    "relationship_naming": {
      "style": "UPPER_SNAKE_CASE",
      "examples": [
        "HAS_MEASUREMENT",
        "VULNERABLE_TO",
        "MANUFACTURED_BY",
        "GOVERNED_BY",
        "USES_PROTOCOL"
      ]
    }
  },
  "cross_sector_query_patterns": {
    "description": "Common query patterns applicable to both sectors",
    "pattern_1_device_vulnerability_chain": {
      "name": "Find all vulnerable devices",
      "query_template": "MATCH (d:Device)-[:VULNERABLE_TO]->(v:Vulnerability) WHERE v.severity = 'Critical' RETURN d, v",
      "water_scenario": "Identify water treatment plants vulnerable to critical CVEs",
      "energy_scenario": "Identify power generation systems vulnerable to critical CVEs"
    },
    "pattern_2_measurement_anomaly_detection": {
      "name": "Find measurements outside normal range",
      "query_template": "MATCH (m:Measurement)-[:MEASURED_BY]->(d:Device) WHERE m.value > m.max OR m.value < m.min RETURN d, m",
      "water_scenario": "pH levels outside safe drinking water range",
      "energy_scenario": "Voltage levels outside nominal operating range"
    },
    "pattern_3_compliance_mapping": {
      "name": "Map devices to applicable standards",
      "query_template": "MATCH (d:Device)-[:GOVERNED_BY]->(s:Standard) WHERE s.sector = $sector RETURN d, COLLECT(s.name)",
      "water_scenario": "Water system compliance with EPA and AWWA standards",
      "energy_scenario": "Power system compliance with NERC CIP and IEEE standards"
    },
    "pattern_4_vendor_ecosystem": {
      "name": "Map vendor impact across infrastructure",
      "query_template": "MATCH (v:Vendor)<-[:MANUFACTURED_BY]-(d:Device)-[:VULNERABLE_TO]->(vuln:Vulnerability) RETURN v.name, COUNT(DISTINCT d), COUNT(DISTINCT vuln)",
      "water_scenario": "Xylem device vulnerabilities impact assessment",
      "energy_scenario": "Siemens device vulnerabilities impact assessment"
    },
    "pattern_5_cascading_failure": {
      "name": "Identify critical dependencies for failure analysis",
      "query_template": "MATCH (d1:Device)-[:HAS_MEASUREMENT]->(m:Measurement), (d2:Device)-[:OPERATES_IN]->[:DEPENDS_ON]->(d1) RETURN d1, COLLECT(DISTINCT d2)",
      "water_scenario": "Critical pump failures affecting distribution network",
      "energy_scenario": "Transformer failures affecting downstream substations"
    },
    "pattern_6_protocol_security": {
      "name": "Assess protocol security across devices",
      "query_template": "MATCH (d:Device)-[:USES_PROTOCOL]->(p:Protocol)-[:VULNERABLE_TO]->(v:Vulnerability) RETURN d, p, v",
      "water_scenario": "Modbus protocol vulnerabilities in water SCADA systems",
      "energy_scenario": "DNP3 protocol vulnerabilities in power systems"
    }
  },
  "implementation_guidelines": {
    "graph_structure": {
      "database_type": "Neo4j or compatible property graph database",
      "node_properties_minimum": {
        "id": "Unique identifier",
        "labels": "Array of Neo4j labels (6-7 per node)",
        "properties": "Key-value pairs specific to node type"
      },
      "index_requirements": [
        "CREATE INDEX ON :Device(id)",
        "CREATE INDEX ON :Measurement(id)",
        "CREATE INDEX ON :Vulnerability(id)",
        "CREATE INDEX ON :Device(sector)",
        "CREATE INDEX ON :Vulnerability(cvssScore)"
      ]
    },
    "data_quality": {
      "validation_rules": [
        "Every node must have 5-7 labels",
        "Every device must have at least one measurement relationship",
        "Every vulnerability must reference a CVE or security issue",
        "Node IDs must be unique within sector",
        "Sector labels must be WATER or ENERGY"
      ],
      "reconciliation_frequency": "Weekly for new vulnerabilities, monthly for infrastructure changes",
      "audit_trail": "Log all changes to vulnerability and device status"
    },
    "integration_points": {
      "external_feeds": [
        "NVD (National Vulnerability Database) for CVE updates",
        "SCADA system telemetry for measurements",
        "SIEM logs for threat actor activities",
        "Maintenance records for device status"
      ],
      "export_formats": [
        "Neo4j Cypher queries",
        "RDF triples for semantic web",
        "GraphQL API for applications"
      ]
    }
  },
  "registry_schema_template": {
    "description": "Template for registering new entities following common patterns",
    "device_registry_entry": {
      "id": "unique-identifier",
      "labels": ["Device", "SectorSpecificType", "Domain", "Monitoring", "SECTOR", "Subsector", "Status"],
      "properties": {
        "name": "Human-readable name",
        "deviceType": "Water/Energy specific type",
        "manufacturer": "Vendor ID reference",
        "location": "Geographic or logical location",
        "operationalStatus": "Operational/Maintenance/Retired",
        "securityLevel": "Critical/High/Medium/Low",
        "lastUpdated": "ISO 8601 timestamp"
      },
      "relationships": [
        {"type": "HAS_MEASUREMENT", "target": "Measurement nodes"},
        {"type": "HAS_PROPERTY", "target": "Property nodes"},
        {"type": "VULNERABLE_TO", "target": "Vulnerability nodes"},
        {"type": "MANUFACTURED_BY", "target": "Vendor node"},
        {"type": "USES_PROTOCOL", "target": "Protocol nodes"},
        {"type": "GOVERNED_BY", "target": "Standard nodes"}
      ]
    },
    "measurement_registry_entry": {
      "id": "unique-identifier",
      "labels": ["Measurement", "MeasurementType", "Domain", "Monitoring", "SECTOR", "Subsector", "Unit"],
      "properties": {
        "name": "pH Level, Voltage, etc.",
        "unit": "pH, V, GPM, etc.",
        "dataType": "Float, Integer, Boolean, String",
        "samplingRate": "Frequency of collection",
        "minValue": "Lower operating bound",
        "maxValue": "Upper operating bound",
        "criticalMin": "Critical alert threshold",
        "criticalMax": "Critical alert threshold"
      },
      "relationships": [
        {"type": "MEASURED_BY", "target": "Device node"},
        {"type": "HAS_TIMESERIES", "target": "TimeSeries node (optional)"}
      ]
    },
    "vulnerability_registry_entry": {
      "id": "CVE-YYYY-XXXXX or similar",
      "labels": ["Vulnerability", "Domain", "Monitoring", "SECTOR", "Severity", "Type"],
      "properties": {
        "cveName": "CVE identifier or description",
        "severity": "Critical/High/Medium/Low",
        "cvssScore": "Numerical CVSS v3 score",
        "description": "Detailed vulnerability description",
        "publishedDate": "ISO 8601 timestamp",
        "affectedProducts": "List of affected vendors/products",
        "mitigation": "Recommended mitigation steps"
      },
      "relationships": [
        {"type": "AFFECTS", "target": "Device nodes"},
        {"type": "MITIGATED_BY", "target": "Standard nodes"}
      ]
    }
  },
  "validation_checklist": {
    "before_registry_creation": [
      "All 8 core node types are defined",
      "Common relationship types are documented",
      "Multi-label rules are testable (5-7 labels)",
      "Gold standard metrics are achievable",
      "Naming conventions are consistent",
      "Cross-sector patterns are applicable to both Water and Energy",
      "Query patterns work on sample data",
      "Node IDs are globally unique",
      "All vulnerability CVEs are traceable"
    ],
    "during_import": [
      "Validate label cardinality (5-7 labels per node)",
      "Verify relationship cardinality (1:N, N:M)",
      "Check for orphaned nodes (nodes without relationships)",
      "Validate sector classification (WATER or ENERGY)",
      "Verify all referenced IDs exist",
      "Check timestamp formats (ISO 8601)",
      "Validate numeric ranges (CVSS 0-10, etc.)"
    ],
    "post_import": [
      "Run cross-sector query patterns against populated graph",
      "Verify node count falls within gold standard range",
      "Validate relationship density (4-8 edges per node)",
      "Test vulnerability impact queries",
      "Verify compliance mapping for standards",
      "Check measurement anomaly detection scenarios"
    ]
  }
}
