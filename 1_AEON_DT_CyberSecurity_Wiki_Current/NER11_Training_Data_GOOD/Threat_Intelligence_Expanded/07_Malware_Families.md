# Malware Families Targeting Railway Infrastructure

## Destructive Malware

### [[MALWARE:Custom_Railway_Wiper]] - Ukraine Operations

**Classification:** [[TYPE:Data_Wiper]]
**Attribution:** [[THREAT_ACTOR:APT28]], [[COUNTRY:Russia]]
**First Observed:** March 2025
**Target:** [[ORGANIZATION:Ukrzaliznytsia]] (Ukrainian Railways)

#### Technical Characteristics

**[[FEATURE:Target-Specific_Customization]]:**
- [[DEVELOPMENT:Malware_Tailored]] for [[ORGANIZATION:Ukrzaliznytsia]] infrastructure
- [[KNOWLEDGE:Victim_Architecture]] analysis required
- [[CUSTOMIZATION:Database_Schema]] understanding
- [[CUSTOMIZATION:Network_Topology]] awareness

**[[FEATURE:Multi-Stage_Payload]]:**
1. [[STAGE:Reconnaissance_Module]] - System enumeration
2. [[STAGE:Privilege_Escalation]] - Administrative access
3. [[STAGE:Lateral_Movement]] - Network propagation
4. [[STAGE:Data_Destruction]] - Wiper execution

**[[FEATURE:Anti-Recovery_Mechanisms]]:**
- [[TECHNIQUE:Backup_System_Targeting]]
- [[TECHNIQUE:Shadow_Copy_Deletion]]
- [[TECHNIQUE:Restore_Point_Elimination]]
- [[TECHNIQUE:Recovery_Tool_Disablement]]

#### Execution Mechanism

**Preparation:**
```
[[PHASE:Infrastructure_Reconnaissance]]
- Map [[TARGET:Ticketing_Systems]]
- Identify [[TARGET:Critical_Databases]]
- Locate [[TARGET:Backup_Infrastructure]]
- Analyze [[TARGET:Recovery_Procedures]]
```

**Destruction:**
```
[[PHASE:Coordinated_Wiper_Execution]]
- [[TECHNIQUE:Master_Boot_Record_Overwrite]]
- [[TECHNIQUE:File_System_Corruption]]
- [[TECHNIQUE:Database_Table_Truncation]]
- [[TECHNIQUE:Partition_Table_Destruction]]
```

#### Impact Analysis

**Systems Affected:**
- [[SYSTEM:Ticketing_Databases]] - Primary target
- [[SYSTEM:Operational_Databases]] - Secondary
- [[SYSTEM:Backup_Systems]] - Tertiary
- [[SYSTEM:Recovery_Infrastructure]] - Quaternary

**Operational Impact:**
- [[IMPACT:Zero_Train_Stoppages]] (strong resilience)
- [[IMPACT:Ticket_Sales_Degradation]]
- [[IMPACT:Online_Services_Disabled]] (48+ hours)
- [[IMPACT:Physical_Queues_Nationwide]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1485]] - Data Destruction
- [[TECHNIQUE:MITRE_ATT&CK:T1490]] - Inhibit System Recovery
- [[TECHNIQUE:MITRE_ATT&CK:T1561.001]] - Disk Content Wipe
- [[TECHNIQUE:MITRE_ATT&CK:T1561.002]] - Disk Structure Wipe
- [[TECHNIQUE:MITRE_ATT&CK:T1489]] - Service Stop

---

### [[MALWARE:GooseEgg]] - APT28 Exploit Tool

**Classification:** [[TYPE:Exploitation_Framework]]
**Attribution:** [[THREAT_ACTOR:APT28]] (Fancy Bear)
**Target Sectors:** [[SECTOR:Transportation]], [[SECTOR:Energy]], [[SECTOR:Government]]

#### Capabilities

**[[FEATURE:Multi-Vector_Exploitation]]:**
- [[VECTOR:Windows_Print_Spooler]] vulnerabilities
- [[VECTOR:SYSTEM-Level_Privileges]] escalation
- [[VECTOR:Lateral_Movement]] capabilities
- [[VECTOR:Persistence_Mechanisms]]

#### Deployment Targets
- [[GEOGRAPHY:Ukraine]] - Transportation sector
- [[GEOGRAPHY:Western_Europe]] - Rail networks
- [[GEOGRAPHY:North_America]] - Transit systems

#### Technical Operation
1. [[STAGE:Initial_Compromise]] via [[TECHNIQUE:Phishing]] or [[TECHNIQUE:Exploit]]
2. [[STAGE:Privilege_Escalation]] using [[MALWARE:GooseEgg]]
3. [[STAGE:Credential_Harvesting]]
4. [[STAGE:Lateral_Movement]] to [[TARGET:Control_Systems]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1068]] - Exploitation for Privilege Escalation
- [[TECHNIQUE:MITRE_ATT&CK:T1003]] - OS Credential Dumping
- [[TECHNIQUE:MITRE_ATT&CK:T1021]] - Remote Services

---

### [[MALWARE:Industroyer]] / [[MALWARE:CRASHOVERRIDE]]

**Classification:** [[TYPE:ICS_Malware]]
**Attribution:** [[THREAT_ACTOR:Sandworm]]
**First Observed:** December 2016 (Ukraine power grid attack)
**Potential Railway Impact:** [[RISK:HIGH]]

#### Technical Capabilities

**[[PROTOCOL:ICS_Protocol_Support]]:**
- [[PROTOCOL:IEC_60870-5-101]] - SCADA communication
- [[PROTOCOL:IEC_60870-5-104]] - Network SCADA
- [[PROTOCOL:IEC_61850]] - Substation automation
- [[PROTOCOL:OLE_for_Process_Control]] (OPC)

**Railway Relevance:**
[[PROTOCOL:IEC_60870-5-104]] is used in:
- [[SYSTEM:Railway_SCADA_Systems]]
- [[SYSTEM:Signaling_Control]]
- [[SYSTEM:Power_Distribution]]
- [[SYSTEM:Track_Circuit_Management]]

#### Attack Capabilities Against Railways

**[[CAPABILITY:Direct_Control_System_Manipulation]]:**
- [[TECHNIQUE:SCADA_Command_Injection]]
- [[TECHNIQUE:Signal_State_Modification]]
- [[TECHNIQUE:Switch_Position_Control]]
- [[TECHNIQUE:Power_Distribution_Disruption]]

**[[CAPABILITY:Coordinated_Multi-System_Attack]]:**
- [[TECHNIQUE:Simultaneous_Disruption]]
- [[TECHNIQUE:Cascading_Failures]]
- [[TECHNIQUE:Recovery_Prevention]]

#### Modular Architecture

**[[MODULE:Main_Backdoor]]:**
- [[FUNCTION:Initial_Access_Maintenance]]
- [[FUNCTION:Command_and_Control]]
- [[FUNCTION:Payload_Deployment]]

**[[MODULE:Data_Wiper]]:**
- [[FUNCTION:Evidence_Destruction]]
- [[FUNCTION:System_Recovery_Prevention]]

**[[MODULE:DoS_Module]]:**
- [[FUNCTION:Service_Disruption]]
- [[FUNCTION:Communication_Blocking]]

**[[MODULE:Protocol_Modules]]:**
- [[MODULE:IEC101]] - Serial SCADA
- [[MODULE:IEC104]] - TCP/IP SCADA
- [[MODULE:IEC61850]] - Substation control
- [[MODULE:OPC]] - Process control

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1205]] - Traffic Signaling (ICS protocols)
- [[TECHNIQUE:MITRE_ATT&CK:T1565.001]] - Stored Data Manipulation
- [[TECHNIQUE:MITRE_ATT&CK:T1498]] - Network Denial of Service
- [[TECHNIQUE:MITRE_ATT&CK:T1485]] - Data Destruction

---

## Ransomware Families

### [[MALWARE:Rhysida_Ransomware]]

**Classification:** [[TYPE:Ransomware]]
**Business Model:** [[MODEL:Double_Extortion]]
**First Observed:** May 2023
**Target Sectors:** [[SECTOR:Healthcare]], [[SECTOR:Education]], [[SECTOR:Transportation]]

#### Technical Features

**[[FEATURE:Encryption_Algorithm]]:**
- [[ALGORITHM:AES-256]] for file encryption
- [[ALGORITHM:RSA-4096]] for key encryption
- [[TECHNIQUE:ChaCha20]] stream cipher (variants)

**[[FEATURE:File_Targeting]]:**
- [[TARGET:Database_Files]] (.mdb, .sql, .dbf)
- [[TARGET:Document_Files]] (.pdf, .docx, .xlsx)
- [[TARGET:Archive_Files]] (.zip, .rar, .7z)
- [[TARGET:Backup_Files]] (.bak, .vhd, .vmdk)

**[[FEATURE:Evasion_Techniques]]:**
- [[TECHNIQUE:Anti-Debug_Mechanisms]]
- [[TECHNIQUE:Anti-VM_Detection]]
- [[TECHNIQUE:Safe_Mode_Boot_Bypass]]
- [[TECHNIQUE:Security_Tool_Termination]]

#### Execution Flow

**Phase 1: [[STAGE:Initial_Access]]**
- [[VECTOR:Phishing_Email]] with malicious attachment
- [[VECTOR:VPN_Credential_Compromise]]
- [[VECTOR:RDP_Exploitation]]

**Phase 2: [[STAGE:Reconnaissance]]**
- [[ACTIVITY:Network_Enumeration]]
- [[ACTIVITY:Data_Discovery]]
- [[ACTIVITY:Backup_Identification]]

**Phase 3: [[STAGE:Data_Exfiltration]]**
- [[TECHNIQUE:Compression]] (WinRAR, 7-Zip)
- [[TECHNIQUE:Upload_to_Attacker_Server]]
- [[TECHNIQUE:TOR-Based_Exfiltration]]

**Phase 4: [[STAGE:Encryption]]**
- [[TECHNIQUE:Volume_Shadow_Copy_Deletion]]
- [[TECHNIQUE:File_Encryption]]
- [[TECHNIQUE:Extension_Change]] to .rhysida

**Phase 5: [[STAGE:Extortion]]**
- [[TECHNIQUE:Ransom_Note_Deployment]]
- [[TECHNIQUE:Payment_Demand]] (Bitcoin)
- [[TECHNIQUE:Data_Leak_Threat]]

#### Notable Attacks

**[[INCIDENT:Port_of_Seattle]]** (August 2024):
- [[TARGET:Dual-Mode_Transportation_Hub]]
- [[IMPACT:Airport_and_Seaport_Disruption]]
- [[DATA:Passenger_and_Cargo_Manifests]] compromised

#### Indicators
- [[INDICATOR:File_Extension:.rhysida]]
- [[INDICATOR:Ransom_Note:CriticalBreachDetected.pdf]]
- [[INDICATOR:Registry_Key:HKLM\SOFTWARE\Rhysida]]
- [[INDICATOR:TOR_Address:rhysidafozdrhh5rmzuv2hb54v7f6ftqj3j7yqhzd3hqewrg2efq2wqqd.onion]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1486]] - Data Encrypted for Impact
- [[TECHNIQUE:MITRE_ATT&CK:T1490]] - Inhibit System Recovery
- [[TECHNIQUE:MITRE_ATT&CK:T1567]] - Exfiltration Over Web Service
- [[TECHNIQUE:MITRE_ATT&CK:T1021.001]] - Remote Desktop Protocol

---

### [[MALWARE:LockBit_3.0]] (Black)

**Classification:** [[TYPE:Ransomware-as-a-Service]]
**Status:** [[STATUS:Disrupted_February_2024]]
**Legacy:** [[STATUS:Affiliates_Active]]
**Peak Activity:** 2022-2024

#### Technical Capabilities

**[[FEATURE:Self-Propagation]]:**
- [[TECHNIQUE:Network_Share_Enumeration]]
- [[TECHNIQUE:Automated_Lateral_Movement]]
- [[TECHNIQUE:Credential_Reuse]]
- [[TECHNIQUE:Exploit-Based_Spreading]]

**[[FEATURE:Anti-Analysis]]:**
- [[TECHNIQUE:Virtual_Machine_Detection]]
- [[TECHNIQUE:Debugger_Detection]]
- [[TECHNIQUE:Sandbox_Evasion]]
- [[TECHNIQUE:String_Obfuscation]]

**[[FEATURE:Process_Termination]]:**
- [[TARGET:Antivirus_Processes]]
- [[TARGET:Backup_Software]]
- [[TARGET:Database_Services]]
- [[TARGET:Email_Servers]]

**[[FEATURE:Domain_Controller_Targeting]]:**
- [[TECHNIQUE:Group_Policy_Abuse]]
- [[TECHNIQUE:Mass_Deployment]]
- [[TECHNIQUE:Credential_Harvesting]]

#### Affiliate Model

**[[MODEL:RaaS_Operation]]:**
- [[ROLE:Core_Developers]] - Malware maintenance
- [[ROLE:Affiliates]] - Initial access and deployment
- [[ROLE:Negotiators]] - Victim communication
- [[REVENUE_SPLIT:30-40%]] to developers

#### Transportation Sector Impact

**Historical Attacks:**
- [[INCIDENT:Multiple_Railway_Operators]]
- [[INCIDENT:Port_Facilities]]
- [[INCIDENT:Trucking_Companies]]
- [[INCIDENT:Aviation_Service_Providers]]

#### Law Enforcement Disruption

**[[OPERATION:Operation_Cronos]]** (February 2024):
- [[ACTION:C2_Infrastructure_Seizure]]
- [[ACTION:Decryption_Keys_Recovery]]
- [[ACTION:Administrator_Arrest]]
- [[RESULT:Operations_Disrupted]] but [[STATUS:Affiliates_Persist]]

#### Indicators
- [[INDICATOR:File_Extension:.lockbit]]
- [[INDICATOR:Ransom_Note:Restore-My-Files.txt]]
- [[INDICATOR:Wallpaper_Change]]
- [[INDICATOR:TOR_Leak_Site]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1059.001]] - PowerShell
- [[TECHNIQUE:MITRE_ATT&CK:T1047]] - Windows Management Instrumentation
- [[TECHNIQUE:MITRE_ATT&CK:T1003.001]] - LSASS Memory Dumping
- [[TECHNIQUE:MITRE_ATT&CK:T1486]] - Data Encrypted for Impact

---

### [[MALWARE:BlackCat]] / [[MALWARE:ALPHV]]

**Classification:** [[TYPE:Ransomware]]
**Programming Language:** [[LANGUAGE:Rust]]
**Status:** [[STATUS:Exit_Scam_March_2024]]
**Innovation:** [[FEATURE:Cross-Platform_Capabilities]]

#### Technical Innovation

**[[FEATURE:Rust_Implementation]]:**
- [[BENEFIT:Memory_Safety]]
- [[BENEFIT:Cross-Platform_Compilation]]
- [[BENEFIT:Performance_Optimization]]
- [[BENEFIT:Modern_Language_Features]]

**[[FEATURE:Platform_Support]]:**
- [[PLATFORM:Windows]] (x86, x64)
- [[PLATFORM:Linux]] (multiple architectures)
- [[PLATFORM:VMware_ESXi]] (virtual infrastructure)

#### Advanced Features

**[[FEATURE:Customizable_Encryption]]:**
- [[ALGORITHM:ChaCha20]] stream cipher
- [[ALGORITHM:AES-128]] (variant)
- [[CONFIGURATION:Selective_Encryption]]
- [[CONFIGURATION:Speed_vs_Thoroughness]]

**[[FEATURE:Triple_Extortion]]:**
1. [[EXTORTION:Data_Encryption]]
2. [[EXTORTION:Data_Exfiltration_and_Leak_Threat]]
3. [[EXTORTION:DDoS_Attack_Threat]]

**[[FEATURE:Access_Broker_Integration]]:**
- [[PARTNERSHIP:Initial_Access_Brokers]]
- [[MARKETPLACE:Dark_Web_Credential_Markets]]
- [[TECHNIQUE:Purchased_VPN_Access]]

#### Transportation Targeting

**Target Systems:**
- [[SYSTEM:Fleet_Management_Systems]]
- [[SYSTEM:Railway_Ticketing_Platforms]]
- [[SYSTEM:Logistics_Software]]
- [[SYSTEM:Port_Management_Systems]]
- [[SYSTEM:VMware_ESXi_Hypervisors]]

#### Indicators
- [[INDICATOR:File_Extension:.alphv]]
- [[INDICATOR:Ransom_Note:RECOVER-FILES.txt]]
- [[INDICATOR:Rust_Compiled_Binary]]
- [[INDICATOR:TOR_Negotiation_Site]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1027]] - Obfuscated Files or Information
- [[TECHNIQUE:MITRE_ATT&CK:T1486]] - Data Encrypted for Impact
- [[TECHNIQUE:MITRE_ATT&CK:T1498]] - Network Denial of Service
- [[TECHNIQUE:MITRE_ATT&CK:T1588.002]] - Obtain Tool

---

### [[MALWARE:Royal_Ransomware]]

**Classification:** [[TYPE:Ransomware]]
**Origin:** [[PREDECESSOR:Conti_Dissolution]]
**Timeline:** September 2022 - Present
**Focus:** [[SECTOR:Critical_Infrastructure]]

#### Technical Characteristics

**[[FEATURE:Partial_Encryption]]:**
- [[TECHNIQUE:Selective_Block_Encryption]]
- [[BENEFIT:Faster_Execution]]
- [[BENEFIT:Lower_Detection_Risk]]
- [[CONFIGURATION:Adjustable_Percentage]]

**[[FEATURE:Multi-Threaded_Execution]]:**
- [[TECHNIQUE:Parallel_File_Processing]]
- [[TECHNIQUE:CPU_Core_Optimization]]
- [[PERFORMANCE:Rapid_Encryption_Speed]]

**[[FEATURE:Callback_Phoning_Home]]:**
- [[TECHNIQUE:C2_Communication]]
- [[TECHNIQUE:Victim_Profiling]]
- [[TECHNIQUE:Exfiltration_Coordination]]

#### Attack Methodology

**[[TECHNIQUE:Callback_Phishing]]:**
1. [[STAGE:Initial_Email]] with urgent callback number
2. [[STAGE:Phone_Social_Engineering]]
3. [[STAGE:Remote_Access_Tool_Installation]]
4. [[STAGE:Network_Compromise]]

**[[TECHNIQUE:Malvertising]]:**
- [[VECTOR:Google_Ads_Exploitation]]
- [[VECTOR:Fake_Software_Downloads]]
- [[VECTOR:Trojanized_Legitimate_Tools]]

**[[TECHNIQUE:Drive-by_Download]]:**
- [[VECTOR:Compromised_Websites]]
- [[VECTOR:Exploit_Kits]]
- [[VECTOR:Malicious_Redirects]]

#### Railway Targeting

**Systems of Interest:**
- [[SYSTEM:Railway_Control_Systems]]
- [[SYSTEM:Traffic_Management_Centers]]
- [[SYSTEM:Public_Transit_Operations]]
- [[SYSTEM:Freight_Logistics_Networks]]

#### Indicators
- [[INDICATOR:File_Extension:.royal]]
- [[INDICATOR:Ransom_Note:README.TXT]]
- [[INDICATOR:Partial_Encryption_Pattern]]
- [[INDICATOR:Command-Line_Parameters]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1204.002]] - Malicious File
- [[TECHNIQUE:MITRE_ATT&CK:T1218.011]] - Rundll32
- [[TECHNIQUE:MITRE_ATT&CK:T1055]] - Process Injection
- [[TECHNIQUE:MITRE_ATT&CK:T1486]] - Data Encrypted for Impact

---

## APT Malware Toolsets

### [[MALWARE:HIGHNOON]] - APT41

**Type:** [[TYPE:Backdoor]]
**Attribution:** [[THREAT_ACTOR:APT41]]

**Capabilities:**
- [[CAPABILITY:Remote_Command_Execution]]
- [[CAPABILITY:File_System_Operations]]
- [[CAPABILITY:Process_Manipulation]]
- [[CAPABILITY:Network_Enumeration]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1071]] - Application Layer Protocol
- [[TECHNIQUE:MITRE_ATT&CK:T1059]] - Command and Scripting Interpreter

---

### [[MALWARE:HOMEUNIX]] - APT41

**Type:** [[TYPE:Trojan]]
**Platform:** [[PLATFORM:Linux]]

**Capabilities:**
- [[CAPABILITY:Persistent_Backdoor]]
- [[CAPABILITY:Log_File_Tampering]]
- [[CAPABILITY:rootkit_Functionality]]

---

### [[MALWARE:CROSSWALK]] - APT41

**Type:** [[TYPE:Modular_Backdoor]]
**Architecture:** [[ARCHITECTURE:Plugin-Based]]

**Modules:**
- [[MODULE:File_Transfer]]
- [[MODULE:Screen_Capture]]
- [[MODULE:Keylogging]]
- [[MODULE:Credential_Theft]]
- [[MODULE:Command_Execution]]

---

### [[MALWARE:DUSTPAN]] - APT41

**Type:** [[TYPE:Credential_Stealer]]

**Target Data:**
- [[DATA:Browser_Credentials]]
- [[DATA:Email_Passwords]]
- [[DATA:FTP_Credentials]]
- [[DATA:Database_Connection_Strings]]

#### TTPs
- [[TECHNIQUE:MITRE_ATT&CK:T1555]] - Credentials from Password Stores
- [[TECHNIQUE:MITRE_ATT&CK:T1552.001]] - Credentials In Files

---

## Legitimate Tools Weaponized

### [[TOOL:Mimikatz]]

**Original Purpose:** [[PURPOSE:Security_Research]]
**Malicious Use:** [[USE:Credential_Dumping]]

**Capabilities:**
- [[CAPABILITY:LSASS_Memory_Extraction]]
- [[CAPABILITY:Kerberos_Ticket_Manipulation]]
- [[CAPABILITY:Hash_Extraction]]
- [[CAPABILITY:Pass-the-Hash_Attacks]]

**Detection:**
- [[DETECTION:AV_Signature_Based]]
- [[DETECTION:Memory_Pattern_Matching]]
- [[DETECTION:Behavioral_Analytics]]

---

### [[TOOL:PsExec]]

**Original Purpose:** [[PURPOSE:System_Administration]]
**Malicious Use:** [[USE:Lateral_Movement]]

**Abuse Patterns:**
- [[PATTERN:Remote_Command_Execution]]
- [[PATTERN:Malware_Deployment]]
- [[PATTERN:Credential_Relay]]

---

### [[TOOL:Cobalt_Strike]]

**Original Purpose:** [[PURPOSE:Penetration_Testing]]
**Malicious Use:** [[USE:Post-Exploitation_Framework]]

**Beacon Capabilities:**
- [[CAPABILITY:C2_Communication]]
- [[CAPABILITY:Process_Injection]]
- [[CAPABILITY:Credential_Harvesting]]
- [[CAPABILITY:Lateral_Movement]]

**Detection:**
- [[DETECTION:Beacon_Network_Signatures]]
- [[DETECTION:Named_Pipe_Patterns]]
- [[DETECTION:Memory_Artifacts]]

---

## Malware Defense Matrix

| [[MALWARE]] | [[DETECTION_METHOD]] | [[MITIGATION]] | [[RECOVERY]] |
|---|---|---|---|
| [[MALWARE:Custom_Railway_Wiper]] | [[DETECTION:Behavioral_Analytics]] | [[MITIGATION:Backup_Isolation]] | [[RECOVERY:Offline_Backups]] |
| [[MALWARE:Rhysida]] | [[DETECTION:EDR]] | [[MITIGATION:Email_Filtering]] | [[RECOVERY:Decryption_Tools]] |
| [[MALWARE:LockBit_3.0]] | [[DETECTION:Network_Traffic_Analysis]] | [[MITIGATION:Segmentation]] | [[RECOVERY:Operation_Cronos_Keys]] |
| [[MALWARE:BlackCat]] | [[DETECTION:Cross-Platform_Monitoring]] | [[MITIGATION:Hypervisor_Hardening]] | [[RECOVERY:Backup_Restoration]] |
| [[MALWARE:Industroyer]] | [[DETECTION:ICS_Protocol_Monitoring]] | [[MITIGATION:Air-Gap]] | [[RECOVERY:Manual_Procedures]] |
