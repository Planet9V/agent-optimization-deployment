# Logging Configuration
# Python logging setup for Cyber DT system

version: 1
disable_existing_loggers: false

# Define formatters
formatters:
  standard:
    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'

  detailed:
    format: '%(asctime)s - %(name)s - %(levelname)s - [%(filename)s:%(lineno)d] - %(funcName)s() - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'

  json:
    format: '{"timestamp": "%(asctime)s", "level": "%(levelname)s", "logger": "%(name)s", "message": "%(message)s"}'

# Define handlers
handlers:
  # Console output
  console:
    class: logging.StreamHandler
    level: DEBUG
    formatter: standard
    stream: ext://sys.stdout

  # Main log file
  file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: detailed
    filename: 'processing/logs/cyberdt.log'
    maxBytes: 10485760           # 10MB
    backupCount: 5

  # Error log file
  error_file:
    class: logging.handlers.RotatingFileHandler
    level: ERROR
    formatter: detailed
    filename: 'processing/logs/errors.log'
    maxBytes: 10485760
    backupCount: 5

  # NVD import log
  nvd_file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: standard
    filename: 'processing/logs/nvd_import.log'
    maxBytes: 5242880            # 5MB
    backupCount: 3

  # spaCy NLP log
  spacy_file:
    class: logging.handlers.RotatingFileHandler
    level: INFO
    formatter: standard
    filename: 'processing/logs/spacy_nlp.log'
    maxBytes: 5242880
    backupCount: 3

  # Database operations log
  database_file:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: 'processing/logs/database.log'
    maxBytes: 10485760
    backupCount: 5

# Define loggers
loggers:
  # Root logger
  root:
    level: INFO
    handlers:
      - console
      - file
      - error_file

  # Application loggers
  cyberdt:
    level: DEBUG
    handlers:
      - console
      - file
    propagate: false

  cyberdt.nvd:
    level: INFO
    handlers:
      - nvd_file
    propagate: false

  cyberdt.nlp:
    level: INFO
    handlers:
      - spacy_file
    propagate: false

  cyberdt.database:
    level: DEBUG
    handlers:
      - database_file
    propagate: false

  # Third-party loggers
  neo4j:
    level: WARNING
    handlers:
      - file
    propagate: false

  neo4j.io:
    level: WARNING

  requests:
    level: WARNING

  urllib3:
    level: WARNING

# Incremental configuration
incremental: false
