Training Prompt KB {{TARGET_SECTOR}} - OPTIMIZED v2.0
100% F1 SCORE GUARANTEE TEMPLATE

## Research Depth
0. **DISCOVERY MODE**: Breadth-first exploration, find new repos/tools/feeds, catalog options, initial surveys
1. **TECHNICAL MODE**: Deep implementation details, code analysis, configuration examples, architecture diagrams
2. **OPERATIONAL MODE**: Deployment guides, scaling strategies, maintenance procedures, troubleshooting, real-world usage
3. **INTEGRATION MODE**: Cross-domain connections, tool chaining, unified architectures, data flow designs

## Sector Detail Focus
{{TARGET_SECTOR}}

## Search Strategy
5. GitHub: `[SECTOR] monitoring control system architecture` + sort by recently updated
6. GitHub: `[SECTOR] network diagram equipment vendor` + sort by relevance
7. GitHub: `neo4j graph analytics big data 100k nodes` + sort by stars

## Query Angle
0. Tool/Platform Features: capabilities, limitations, tech stack, dependencies, scalability
1. Implementation Patterns: code examples, configurations, deployment architectures, best practices
2. Vendor/Equipment Deep Dive: manufacturers, specific models, protocols, interfaces, specifications
3. Architecture/Design Patterns: facility layouts, network topologies, system integration, redundancy
4. Operations/Maintenance: procedures, monitoring, troubleshooting, lifecycle management, upgrades
5. Security/Vulnerabilities: known CVEs, threat actors, attack vectors, mitigations, hardening

## üö® MANDATORY SPECIFICITY REQUIREMENTS (100% F1 GUARANTEE)

### ZERO-TOLERANCE GENERIC PHRASES (Auto-Reject if Found)
The following phrases are FORBIDDEN and will cause validation failure:
- "Various", "Multiple", "Several", "Different", "Many", "Some", "Numerous"
- "Typical", "Common", "Standard", "General", "Usually", "Often"
- "Major vendors", "Leading manufacturers", "Industry players"
- ANY mention without specific model numbers, versions, or specifications

### REQUIRED SPECIFICITY FORMATS

#### Equipment References (MANDATORY)
‚úÖ CORRECT: "Allen-Bradley ControlLogix L85E CPU with 10 MB user memory, 5000 I/O points, dual Ethernet ports"
‚ùå WRONG: "ControlLogix PLC", "Various PLCs", "Multiple controllers"

**Format**: Manufacturer + Series + Model + Variant + Specifications
**Minimum per page**: 6+ specific equipment models with full details

#### Protocol References (MANDATORY)
‚úÖ CORRECT: "Modbus TCP (RFC-compliant, TCP port 502, 100 Mbps Ethernet, function codes 0x01-0x06)"
‚ùå WRONG: "Modbus", "Industrial protocols", "Communication standards"

**Format**: Protocol + Version + Implementation Details (ports, speeds, standards)
**Minimum per page**: 4+ protocol versions with technical specifications

#### Vendor References (MANDATORY)
‚úÖ CORRECT: "Rockwell Automation, Inc. (Allen-Bradley division): ControlLogix 5580 series (L85E, L83E, L82E models), CompactLogix 5380 series, supporting EtherNet/IP CIP Safety v3.2, Modbus TCP server"
‚ùå WRONG: "Rockwell", "Major automation vendors", "Leading PLC manufacturers"

**Format**: Full Legal Entity + Division + Product Lines + Specific Models + Protocol Support
**Minimum per page**: 3+ vendors with 8+ models each

### ENTITY DENSITY TARGETS (Pattern Extraction Validation)

**Per Page Requirements**:
- VENDOR entities: 15-20 minimum
- EQUIPMENT entities: 20-25 minimum
- PROTOCOL entities: 12-15 minimum
- OPERATION entities: 30-40 minimum (procedure pages)
- ARCHITECTURE entities: 40-50 minimum (architecture pages)
- SECURITY entities: 25-30 minimum (security pages)

### VALIDATION CHECKPOINT (Before Submission)
Run this checklist on ALL generated content:

- [ ] Search content for forbidden generic phrases ‚Üí COUNT: must be 0
- [ ] Count specific product models (Manufacturer + Model format) ‚Üí MINIMUM: 15 unique
- [ ] Count protocol versions (Protocol + Version format) ‚Üí MINIMUM: 12 unique
- [ ] Count technical specifications with values+units ‚Üí MINIMUM: 20 per page
- [ ] Verify every equipment mention includes manufacturer name
- [ ] Verify every protocol mention includes version or standard reference
- [ ] Verify no equipment/protocol/vendor mentioned without context

## Research Execution

### STEP 1: Discovery (Target: 6-8 repos)
Execute curl commands to GitHub API:

For each result:
- Extract: name, description, stars, last_push_date, main_language, topics
- Identify: key features, use cases, installation, configuration, examples
- Note vendor names, equipment types, protocols, standards mentioned
- **SPECIFICITY REQUIREMENT**: Extract full model numbers, version strings, protocol specifications

### STEP 2: Documentation Deep Dive (Target: 4-6 sources)
For selected high-value sources:
````

````

Extract:
- Technical architecture details with specific product models
- Configuration templates with actual version numbers
- Integration points with protocol specifications
- Scaling considerations for large graphs (300k+ nodes)
- Multi-label handling techniques with specific implementations
- Relationship type management with concrete examples
- Query optimization for complex Cypher with actual query patterns
- **SPECIFICITY REQUIREMENT**: Every technical detail must include specific values, versions, model numbers

### STEP 3: Threat Intelligence & Vulnerability Research (Target: 3-4 sources)
Rotate through:
````
curl https://cve.mitre.org/data/downloads/allitems.csv
curl https://nvd.nist.gov/feeds/json/cve/1.1/nvdcve-1.1-recent.json
curl https://www.cisa.gov/known-exploited-vulnerabilities-catalog [if accessible]
````

Focus on:
- ICS/SCADA/OT specific vulnerabilities with CVE IDs
- [SECTOR]-related CVEs with affected product versions
- Vendor-specific advisories with patch levels
- Exploit availability with specific exploit names/IDs
- Mitigation strategies with concrete configuration changes
- **SPECIFICITY REQUIREMENT**: Every vulnerability must include CVE-ID, affected versions, patch version

### STEP 4: Vendor & Equipment Research (Target: 5-7 vendors)
For current sector, research:
- Primary equipment manufacturers with full legal entity names
- Specific product lines (series names, model numbers, generation identifiers)
- Technical specifications:
  - Modbus TCP/RTU (specific function codes, data rates, slave IDs)
  - DNP3 (version 3.0, IEC 60870-5-101/104, secure authentication)
  - IEC 61850 (MMS, GOOSE, SV messaging, edition numbers)
  - OPC UA (version 1.04, security policies, information models)
  - BACnet (protocol version, object types, services)
- Network architectures (specific VLAN IDs, subnet ranges, switch models)
- Engineering design standards:
  - ISA-95 (specific level definitions, integration points)
  - IEC 62443 (security level targets with SL ratings)
  - NIST SP 800-82 Rev 2 (specific section references)
- Supply chain (specific distributors with locations, integrators with service areas)
- **SPECIFICITY REQUIREMENT**: Every vendor must have 8+ specific product models with full specifications

### STEP 5: Knowledge Base Page Generation (TARGET: 29-36 pages)

**CRITICAL**: Page allocation MUST match Manufacturing success distribution to achieve 100% F1 score.

**Manufacturing Pattern Analysis** (692 patterns, 100% F1):
- OPERATION: 22% of patterns (152 patterns)
- SECURITY: 21% of patterns (145 patterns)
- VENDOR: 14.9% of patterns (103 patterns)
- ARCHITECTURE: 14.2% of patterns (98 patterns)
- EQUIPMENT: 11.1% of patterns (77 patterns)
- PROTOCOL: 10.4% of patterns (72 patterns)
- SUPPLIER: 6.5% of patterns (45 patterns)

**OPTIMIZED PAGE ALLOCATION** (Matches proven distribution):

#### Security Pages: 5-6 pages (21% of content)
**Target**: 120-150 security patterns

1. `kb/sectors/[SECTOR]/security/security-architecture-[YYYYMMDD-HH].md` (1000 words)
   - Network security zones with specific Cisco/Palo Alto/Fortinet firewall models
   - IEC 62443 security levels (SL 1-4) implementation with specific controls
   - NIST SP 800-82 Rev 2 compliance mapping (sections 5.3, 5.4, 5.5)
   - Specific VLAN IDs, subnet ranges, firewall rules
   - **MANDATORY**: 25-30 security entity patterns per page

2. `kb/sectors/[SECTOR]/security/vendor-security-[VENDOR1]-[YYYYMMDD-HH].md` (500 words)
   - Siemens SIMATIC S7-1500 security: TLS 1.3, X.509 certificates, RBAC
   - Rockwell ControlLogix 5580 security: CIP Safety, secure backplane, EtherNet/IP security
   - Schneider Electric EcoStruxure security: edge encryption, secure boot
   - Specific CVE history (CVE-2019-xxxxx) with patch versions
   - Security protocols: TLS 1.2/1.3, SSH v2, RADIUS, TACACS+
   - **MANDATORY**: 20-25 security entity patterns per page

3-4. Additional vendor security pages (500 words each)
   - Cover remaining major vendors: Honeywell, Emerson, ABB, GE
   - Each with specific product security features and CVE history
   - **MANDATORY**: 20-25 security entity patterns per page

5. `kb/sectors/[SECTOR]/security/protocol-security-[YYYYMMDD-HH].md` (500 words)
   - Modbus TCP: no authentication, plaintext (CVE-2016-9349), Modbus Security (port 802)
   - EtherNet/IP: CIP Security extension, TLS wrapping, certificate-based auth
   - OPC UA: security modes (Sign, SignAndEncrypt), security policies (Basic256Sha256)
   - Known vulnerabilities: CVE-2020-15782 (ProfiNet), CVE-2018-7789 (OPC UA)
   - Mitigation strategies: VPN tunneling (Cisco AnyConnect, OpenVPN), application firewalls
   - **MANDATORY**: 25-30 security entity patterns per page

6. `kb/sectors/[SECTOR]/security/threat-landscape-[YYYYMMDD-HH].md` (500 words)
   - Sector-specific threats: Triton/Trisis, Industroyer/CrashOverride, specific malware families
   - MITRE ATT&CK for ICS techniques: T0800-T0884 with specific technique IDs
   - Recent security incidents: Colonial Pipeline (2021), Oldsmar water treatment (2021)
   - Threat actors: Sandworm, APT33, XENOTIME with specific TTPs
   - **MANDATORY**: 25-30 security entity patterns per page

#### Operations Pages: 6-8 pages (22% of content)
**Target**: 140-160 operation patterns

1. `kb/sectors/[SECTOR]/operations/operational-workflows-[YYYYMMDD-HH].md` (1500 words)
   - Normal operations with specific HMI screen navigation (Wonderware InTouch screens 001-050)
   - Shift patterns: 12-hour DuPont schedule, 8-hour rotating shifts
   - KPI monitoring: OEE (target 85%), MTBF (target 2000 hours), MTTR (target < 4 hours)
   - Specific alarm priorities: Critical (< 10 alarms/day), High (< 50/day), Low (< 200/day)
   - Production reporting: PI System tags, Historian queries, SQL views
   - **MANDATORY**: 35-40 operation entity patterns per page

2-3. `kb/sectors/[SECTOR]/operations/procedure-[TASK]-[YYYYMMDD-HH].md` (400 words each)
   - Startup sequence with specific PLC tags (PLC-01.StartSeq.Step1-20)
   - Equipment IDs (P-101, V-205, HX-304) with specific actions
   - Setpoints with values: Temperature (350¬∞F ¬±5¬∞F), Pressure (150 psig ¬±10 psig)
   - Interlock verification: Safety interlocks INT-001 through INT-025
   - HMI navigation: Screen paths (Main ‚Üí Area1 ‚Üí Equipment ‚Üí Detail)
   - **MANDATORY**: 30-35 operation entity patterns per page

4-5. `kb/sectors/[SECTOR]/operations/control-operations-[YYYYMMDD-HH].md` (400 words each)
   - PLC tag names: PLC_AREA1.PID_LOOP_01.PV, PLC_AREA1.MOTOR_STATUS_BITS
   - HMI screen numbers: SCR-001 (Overview), SCR-101 (Area 1 Detail), SCR-201 (Alarms)
   - Modbus registers: 40001 (Process Variable), 40102 (Setpoint), function code 0x03 (Read Holdings)
   - OPC UA node IDs: ns=2;s=Area1.Equipment.Temperature, ns=2;s=Area1.Equipment.Pressure
   - Control algorithms: PID loops with specific tuning (Kp=2.5, Ki=0.1, Kd=0.05)
   - **MANDATORY**: 30-35 operation entity patterns per page

6-7. `kb/sectors/[SECTOR]/operations/maintenance-[TYPE]-[YYYYMMDD-HH].md` (400 words each)
   - Preventive maintenance: Equipment P-101 (weekly bearing inspection), V-205 (monthly valve testing)
   - PM schedules: Weekly (W-001 through W-025), Monthly (M-001 through M-050), Annual (A-001 through A-010)
   - Predictive maintenance: Vibration sensors (Emerson AMS 6500), thermography (FLIR E95)
   - Condition monitoring: Oil analysis (ISO 4406 cleanliness), vibration (ISO 10816 standards)
   - CMMS integration: IBM Maximo work orders, SAP PM notifications
   - **MANDATORY**: 30-35 operation entity patterns per page

8. `kb/sectors/[SECTOR]/operations/alarm-management-[YYYYMMDD-HH].md` (400 words)
   - Alarm priorities: Critical (red, audible horn, requires acknowledgment within 10 seconds)
   - Priority levels: P1 (emergency), P2 (abnormal), P3 (advisory), P4 (informational)
   - Response procedures: Critical alarm checklist (CRIT-001 through CRIT-050)
   - Escalation matrix: Operator ‚Üí Supervisor (5 min) ‚Üí Manager (15 min) ‚Üí Director (30 min)
   - Alarm suppression: During startup (SUP-STARTUP), maintenance (SUP-MAINT), shutdown (SUP-SHUTDOWN)
   - ISA-18.2 compliance: Alarm rate < 6/hour steady-state, < 10/hour upset, chattering < 3 repeats/minute
   - **MANDATORY**: 30-35 operation entity patterns per page

#### Architecture Pages: 3-4 pages (14% of content)
**Target**: 90-110 architecture patterns

1. `kb/sectors/[SECTOR]/architectures/facility-[FACILITY_TYPE]-[YYYYMMDD-HH].md` (2000 words)
   [COMPREHENSIVE FACILITY ARCHITECTURE - KEEP EXISTING STRUCTURE FROM ORIGINAL]
   [Enhanced with specificity requirements below]
   - **MANDATORY**: 40-50 architecture entity patterns per page
   - Every system must include 3+ vendor names with 5+ specific models
   - Every capacity must include actual values with units
   - Every network segment must include VLAN IDs, subnet ranges, switch models

2. `kb/sectors/[SECTOR]/architectures/network-architecture-[YYYYMMDD-HH].md` (1000 words)
   - Purdue Model implementation:
     - Level 0: Field devices (500+ I/O points, HART sensors, Foundation Fieldbus H1)
     - Level 1: PLCs (Allen-Bradley ControlLogix L85E, Siemens S7-1518-4 PN/DP)
     - Level 2: SCADA (Wonderware System Platform 2023, GE iFIX 6.5)
     - Level 3: MES (Siemens Opcenter, Rockwell FactoryTalk Production Centre)
     - Level 4: ERP (SAP S/4HANA, Oracle E-Business Suite)
   - Network topology: Industrial Ethernet with star topology at Level 2, DLR ring at Level 1
   - Specific switch models: Cisco IE-4000-16T4G-E (Level 1), Cisco IE-5000-16S12P (Level 2)
   - VLAN segmentation:
     - VLAN 100 (192.168.100.0/24): Field network
     - VLAN 200 (192.168.200.0/24): Control network
     - VLAN 300 (192.168.300.0/24): SCADA network
     - VLAN 400 (192.168.400.0/24): Enterprise DMZ
   - Firewall policies: Palo Alto PA-3220 NGFW with specific rule IDs and port restrictions
   - Mermaid diagram with equipment models, IP ranges, VLAN IDs
   - **MANDATORY**: 40-50 architecture entity patterns per page

3. `kb/sectors/[SECTOR]/architectures/integration-architecture-[YYYYMMDD-HH].md` (500-1000 words)
   - IT/OT integration: OPC UA server (Matrikon OPC UA Gateway v2.0) bridging PLC to SCADA
   - ERP integration: SAP PI/PO middleware, RFC calls, IDoc messages
   - Specific integration points:
     - Production data: OPC UA ‚Üí SQL Server 2019 ‚Üí SAP HANA
     - Maintenance: ControlLogix alarms ‚Üí Maximo work orders via REST API
     - Quality: Lab results (CSV) ‚Üí FTP ‚Üí Manufacturing Execution System
   - Data flow rates: 10,000 tags/second, 100 MB/hour historian storage
   - **MANDATORY**: 40-50 architecture entity patterns per page

4. `kb/sectors/[SECTOR]/architectures/redundancy-architecture-[YYYYMMDD-HH].md` (500 words)
   - Controller redundancy: ControlLogix 1756-L85E with 1756-L85E backup, hot-standby mode
   - Bumpless transfer: < 100 ms switchover, no process disturbance
   - Network redundancy: Device Level Ring (DLR) protocol, 6 ms failover
   - Cisco Resilient Ethernet Protocol (REP) for Level 2 network
   - Server redundancy: VMware vSphere HA cluster, 3-node configuration
   - SCADA server: Active-active configuration with SQL Server Always On Availability Groups
   - **MANDATORY**: 40-50 architecture entity patterns per page

#### Vendor Pages: 4-5 pages (15% of content)
**Target**: 100-120 vendor patterns

1-5. `kb/sectors/[SECTOR]/vendors/vendor-[COMPANY]-[YYYYMMDD-HH].md` (500 words each)

**Required vendors (minimum)**:
- Rockwell Automation (Allen-Bradley)
- Siemens
- Schneider Electric
- Honeywell
- Emerson

**Enhanced specificity requirements per vendor page**:
- Full legal entity name with headquarters location
- Product portfolio with 8+ specific models:
  - PLCs: 3+ models with CPU specs, I/O capacity, communication ports
  - HMIs: 2+ models with screen size, resolution, touch type
  - SCADA: Version numbers, licensing model, supported protocols
  - Network gear: 2+ switch/router models with port counts
- Protocol support matrix:
  - Native protocols with version numbers
  - Gateway protocols with conversion capabilities
  - Security protocols with encryption standards
- Market position: Approximate market share percentage in sector
- Certifications: UL, CE, IEC standards compliance with certificate numbers
- Support model: Tier structure, response SLAs, parts availability
- **MANDATORY**: 15-20 vendor entity patterns per page
- **MANDATORY**: Each vendor must have 8+ equipment models with full specifications

#### Equipment Pages: 4-5 pages (11% of content)
**Target**: 80-100 equipment patterns

1-5. `kb/sectors/[SECTOR]/equipment/device-[CATEGORY]-[YYYYMMDD-HH].md` (400 words each)

**Required categories (minimum)**:
- PLCs (Programmable Logic Controllers)
- HMIs (Human-Machine Interfaces)
- SCADA servers
- RTUs (Remote Terminal Units)
- Industrial networking equipment

**Enhanced specificity requirements per equipment page**:
- 5+ specific models with full specifications:
  - Model number with variant codes
  - CPU/processor type and speed
  - Memory capacity (work memory, load memory)
  - I/O capacity (digital inputs, digital outputs, analog channels)
  - Communication ports (Ethernet, serial, USB) with specifications
  - Power requirements with voltage and current ratings
  - Environmental ratings (temperature range, IP rating, vibration spec)
  - MTBF rating in hours
  - Physical dimensions and weight
- Protocol support with specific versions and implementations
- Programming/configuration tools with version numbers
- Certifications with standard numbers
- Typical applications with specific use case details
- Integration examples with other equipment models
- Pricing: Order of magnitude cost range
- **MANDATORY**: 20-25 equipment entity patterns per page

#### Protocol Pages: 4-5 pages (10% of content)
**Target**: 70-90 protocol patterns

1-5. `kb/sectors/[SECTOR]/protocols/protocol-[NAME]-[YYYYMMDD-HH].md` (400 words each)

**Required protocols (minimum)**:
- Modbus TCP/RTU
- EtherNet/IP (CIP)
- PROFINET
- OPC UA
- DNP3

**Enhanced specificity requirements per protocol page**:
- Full protocol name with standard reference:
  - Modbus: Modbus TCP (IETF RFC compliant), Modbus RTU (serial)
  - EtherNet/IP: ODVA EtherNet/IP specification, CIP Volume 1-8
  - PROFINET: IEC 61158/IEC 61784, PROFINET IRT/RT
  - OPC UA: IEC 62541 parts 1-14, version 1.04 specification
  - DNP3: IEEE 1815-2012 (DNP3 SAv5), IEC 60870-5
- Protocol specifications:
  - OSI layer(s): Application (Layer 7), Transport (Layer 4), etc.
  - Transport protocol: TCP, UDP, direct Ethernet
  - Port numbers: TCP 502 (Modbus), TCP 44818 (EtherNet/IP), TCP 4840 (OPC UA)
  - Data encoding: Big-endian, little-endian, binary, ASCII
  - Frame structure: Header format, payload, CRC/checksum
  - Address space: Register ranges, memory map, tag structure
- Implementation details:
  - Master-slave vs peer-to-peer vs publish-subscribe
  - Connection types: Explicit messaging, implicit messaging, cyclic, acyclic
  - Data types supported: Boolean, integer, float, string, structures
  - Real-time capabilities: Cycle times, jitter tolerance, determinism
- Security analysis:
  - Built-in security: Authentication, encryption, integrity checking
  - Known vulnerabilities: Specific CVE numbers
  - Security extensions: TLS wrapping, VPN tunneling, secure variants
  - Mitigation strategies with specific implementations
- Vendor implementations:
  - 5+ vendors supporting this protocol with specific product models
  - Implementation variations and proprietary extensions
  - Gateway devices for protocol conversion with model numbers
- **MANDATORY**: 12-15 protocol entity patterns per page

#### Supplier Pages: 2-3 pages (7% of content)
**Target**: 40-60 supplier patterns

1-3. `kb/sectors/[SECTOR]/suppliers/supplier-[TYPE]-[YYYYMMDD-HH].md` (400 words each)

**Enhanced specificity requirements per supplier page**:
- Full legal entity names with headquarters and regional office locations
- Service areas: Geographic coverage with specific states/regions
- Product lines supplied: Specific manufacturer partnerships
- Distribution channels: Direct, wholesale, online, field sales
- Technical capabilities: Engineering support, commissioning, training
- Certifications: Manufacturer authorizations, quality certifications
- Support model: Response times, parts availability, emergency service
- **MANDATORY**: 10-15 supplier entity patterns per page

#### Standards Pages: 1-2 pages (Bonus)
**Target**: 20-30 standard references

1. `kb/sectors/[SECTOR]/standards/standards-overview-[YYYYMMDD-HH].md` (500 words)

**Enhanced specificity requirements**:
- Standard full title, issuing organization, publication year
- Specific section references with applicability
- Compliance requirements with certification details
- Related standards with cross-references
- Implementation guidance with specific examples
- **MANDATORY**: Standard name + section number + specific requirement format

#### Control System Architecture: 1 page (MANDATORY)
1. `kb/sectors/[SECTOR]/control-systems/[SECTOR]-control-system-[YYYYMMDD-HH].md` (2000 words)
   [COMPREHENSIVE CONTROL SYSTEM ARCHITECTURE - KEEP EXISTING STRUCTURE FROM ORIGINAL]
   [Enhanced with specificity requirements]
   - **MANDATORY**: 40-50 architecture entity patterns per page
   - Every layer must include 3+ specific equipment models with full specifications
   - Every protocol must include version, port, and data rate
   - Every network segment must include switch model, VLAN ID, subnet

**TOTAL**: 29-36 pages (optimized for 100% F1)

### STEP 5A: MANDATORY PAGE STRUCTURE (100% F1 Enforcement)

**CRITICAL**: Every page MUST follow this structure to ensure pattern extractability.

#### MANDATORY 4-SECTION STRUCTURE (ALL PAGES)

**Section 1: Entity-Rich Introduction (150-200 words)**

Requirements:
- [ ] First paragraph names 3+ specific entities with full details
- [ ] Includes 1+ vendor name WITH model numbers (not just vendor name)
- [ ] Includes 1+ protocol WITH version/standard (not just protocol name)
- [ ] Uses active verbs describing specific operations (monitors, controls, manages)
- [ ] NO generic phrases allowed (see forbidden list above)

Example (PASS - Manufacturing pattern):
"Siemens SIMATIC S7-1500 PLCs (models CPU 1516-3 PN/DP and CPU 1518-4 PN/DP) control robotic welding operations in automotive assembly lines, communicating via PROFINET IRT with 10ms cycle times and 1ms jitter tolerance. Integration with Rockwell Automation PanelView Plus 7 HMIs (models 2711P-T15C4D9 and 2711P-T19C4D9) through OPC UA 1.04 server enables operators to monitor real-time production KPIs including cycle time (target: 45 seconds), weld quality metrics (torque 50-75 Nm), and production count (target: 800 units/shift)."

Example (FAIL - too generic):
"PLCs control industrial processes using various communication protocols. HMI systems provide operator interfaces for monitoring production metrics and system performance."

**Section 2: Technical Specifications Table (5-10 bullet points - MANDATORY)**

Requirements:
- [ ] 5-10 bullet points minimum in structured format
- [ ] Format: "Field: Specific Value with Unit" (never without values)
- [ ] Include: Models, versions, protocols, standards, specifications
- [ ] Every specification must have actual values (not ranges like "up to" or "varies")
- [ ] NO generic phrases: "various", "multiple", "high-performance", "industrial-grade"

Example (PASS):
```markdown
**Technical Specifications**:
- Model: Siemens S7-1500 CPU 1516-3 PN/DP
- User Memory: 1.5 MB work memory, 8 MB load memory
- I/O Capacity: 32,768 digital inputs/outputs, 4,096 analog channels
- Communication: PROFINET IRT controller/device, EtherNet/IP adapter, Modbus TCP server
- Cycle Time: 1 ms typical, 10 ms maximum
- Programming: TIA Portal V17, languages: SCL, LAD, FBD, GRAPH, S7-SCL
- Security: TLS 1.3, X.509 v3 certificates, role-based access control (10 user roles)
- Environmental: Operating temp -25¬∞C to +60¬∞C, IP20 rating, vibration 5 Hz to 150 Hz
- Certifications: IEC 61131-3, IEC 62443-4-1 SL 2, UL 508, CE marked
- MTBF: 450,000 hours (51.4 years), warranty: 3 years
```

Example (FAIL):
```markdown
**Specifications**:
- Various models available
- Flexible I/O configuration
- Multiple communication options
- Fast cycle times
- Modern programming tools
- Security features included
```

**Section 3: Integration & Operations (200-300 words)**

Requirements:
- [ ] Describes 3+ specific operational scenarios with equipment identifiers
- [ ] Names specific systems that integrate (vendor + model + protocol + version)
- [ ] Uses action verbs with specific objects (not generic "processes data")
- [ ] Includes specific metrics: cycle times, capacities, throughput, response times
- [ ] References actual deployed equipment with identifiers (PLC-AREA1-01, HMI-MAIN-02)

Example (PASS):
"S7-1500 PLC array (PLC-WELD-01 through PLC-WELD-08) coordinates 8 KUKA KR 5 robotic welding stations via PROFINET IRT, managing weld parameters transmitted at 10ms intervals with 1ms jitter. Each PLC controls: (1) Robot position via 12 axis servo drives (Siemens Sinamics S120), (2) Weld current/voltage (Miller Dynasty 350 welders via EtherNet/IP), (3) Part presence verification (Keyence LR-W series laser sensors), (4) Quality monitoring (torque sensors 50-75 Nm range). OPC UA 1.04 integration with Wonderware System Platform 2023 SCADA enables operators at HMI-MAIN-01 and HMI-MAIN-02 (PanelView Plus 7 15-inch touchscreens) to monitor: real-time cycle time (45-second target, 40-50 second acceptable range), weld quality dashboard (torque, current, voltage trends), production count (800 units/shift target, 750 minimum acceptable), and downtime tracking (target <5% per shift)."

Example (FAIL):
"PLCs coordinate robotic operations using industrial protocols. SCADA integration provides operator visibility. Quality metrics are monitored and tracked. Production targets are managed through the control system."

**Section 4: Security Implementation (100-150 words)**

Requirements:
- [ ] Names 3+ specific security technologies with versions
- [ ] Includes protocols: TLS versions, authentication methods, encryption standards
- [ ] Mentions specific controls: firewall rules, IDS signatures, access policies
- [ ] References standards: IEC 62443 (with section numbers), NIST SP 800-82 (with sections)
- [ ] Describes actual implementation (not just "security is important")

Example (PASS):
"Network security implements Cisco Industrial Ethernet 4000 Series switches (models IE-4000-16T4G-E) with IEC 62443-4-2 SL 2 compliance, segmenting operational technology (VLAN 100, 192.168.100.0/24) from enterprise networks (VLAN 10). S7-1500 authentication uses TLS 1.3 with 2048-bit RSA X.509 v3 certificates issued by internal PKI (Microsoft AD CS), RBAC synchronized with Active Directory via LDAP over TLS. Firewall rules (Palo Alto PA-220 NGFW running PAN-OS 10.2) enforce: (1) PROFINET traffic isolation to VLAN 100 only, (2) OPC UA restricted to ports 4840-4843 from SCADA servers only, (3) Engineering access via VPN (Cisco AnyConnect SSL VPN) with MFA (RSA SecurID tokens). Deep packet inspection validates PROFINET frame structure and flags anomalies (IDS signatures S-45678, S-45679 for PROFINET attacks). Compliance: IEC 62443-3-3 SR 1.1 (Human User Identification), SR 2.1 (Authorization Enforcement), NIST SP 800-82 Rev 2 Section 5.3 (Network Segmentation)."

Example (FAIL):
"Security features include network segmentation, firewall protection, and access controls. Industry standards are followed. Encryption is used for communications. Monitoring systems detect security events."

#### VALIDATION REQUIREMENTS (Before Page Completion)

Run this validation on EVERY page before marking complete:

‚úÖ **Entity Density Test**:
- [ ] Count extractable entities in first 200 words: TARGET ‚â•10-15 entities
- [ ] Count equipment with manufacturer+model: TARGET ‚â•6 per page
- [ ] Count protocols with version+detail: TARGET ‚â•4 per page
- [ ] Count vendors with products: TARGET ‚â•3 per page

‚úÖ **Generic Phrase Test** (Zero Tolerance):
- [ ] Search for forbidden phrases (various, multiple, several, typical, common)
- [ ] COUNT must equal 0 (zero instances allowed)
- [ ] If found: Replace with specific examples immediately

‚úÖ **Structure Compliance Test**:
- [ ] Page has all 4 required sections
- [ ] Section 2 has 5-10 bullet points in "Field: Value" format
- [ ] Section 3 has 3+ specific operational scenarios
- [ ] Section 4 has 3+ specific security technologies

‚úÖ **Specificity Test**:
- [ ] Every equipment mention includes manufacturer
- [ ] Every protocol mention includes version or standard
- [ ] Every specification includes value with unit
- [ ] No mentions without context

**IF ANY VALIDATION FAILS**: Revise page before proceeding to next page.

### STEP 6: Cross-Referencing and Validation

### Mandatory Cross-References
The two comprehensive reports MUST reference each other:
- Facility Architecture report links to Control System Architecture report
- Control System Architecture report links to Facility Architecture report
- Both link to relevant equipment, protocol, vendor, and security pages created

### Content Validation Checklist
For the two comprehensive reports, verify:
- [ ] Minimum 2000 words each (excluding code/diagrams)
- [ ] 3+ Mermaid diagrams per report
- [ ] 8-15 authoritative references
- [ ] 5-7 vendor/manufacturer mentions with specific models (8+ models per vendor)
- [ ] 4-6 protocols detailed with specifications (version + implementation details)
- [ ] Hierarchical architecture with 3-5 levels
- [ ] Security considerations section substantial (500+ words)
- [ ] Network architecture diagram included
- [ ] Equipment specifications with vendor details
- [ ] Integration patterns clearly described
- [ ] Zero generic phrases (various, multiple, typical, common)
- [ ] All entity density targets met
- [ ] All 4-section structure requirements met on all pages

### STEP 7: Tracking & Deduplication

Create/Update: `kb/tracking/session-[HOUR_ID].json`
````json
{
  "session_id": [HOUR_ID],
  "timestamp": "[ISO8601]",
  "rotation_indices": {
    "domain": [0-6],
    "depth": [0-3],
    "sector": [0-12],
    "strategy": [0-7],
    "angle": [0-5]
  },
  "comprehensive_reports_generated": {
    "facility_architecture": "[filename]",
    "control_system_architecture": "[filename]",
    "word_count_facility": [count],
    "word_count_control": [count]
  },
  "research_completed": {
    "github_repos": ["owner/repo1", "owner/repo2", ...],
    "urls_visited": ["url1", "url2", ...],
    "vendors_documented": ["Vendor1", "Vendor2", ...],
    "equipment_documented": ["Model1", "Model2", ...],
    "protocols_analyzed": ["Protocol1", "Protocol2", ...],
    "pages_created": 32,
    "security_pages": 6,
    "operations_pages": 7,
    "vendor_pages": 5,
    "equipment_pages": 5,
    "protocol_pages": 5,
    "architecture_pages": 4,
    "supplier_pages": 2,
    "comprehensive_reports": 2
  },
  "entity_pattern_counts": {
    "total_entities": 1250,
    "vendor_patterns": 180,
    "equipment_patterns": 245,
    "protocol_patterns": 135,
    "operation_patterns": 310,
    "architecture_patterns": 220,
    "security_patterns": 160
  },
  "specificity_validation": {
    "generic_phrases_found": 0,
    "specific_models_documented": 87,
    "protocol_versions_documented": 45,
    "vendor_models_per_vendor": 9.2,
    "technical_specs_with_values": 523
  },
  "topics_covered": ["topic1", "topic2", ...],
  "next_cycle_preview": {
    "domain": "[NEXT DOMAIN]",
    "sector": "[NEXT SECTOR]",
    "recommended_focus": ["area1", "area2"]
  }
}
````

Update: `kb/tracking/master-index.json`
````json
{
  "total_sessions": N,
  "total_pages": N,
  "comprehensive_reports": {
    "total": N,
    "by_sector": {
      "Energy": {"facility": N, "control": N},
      "Chemical": {"facility": N, "control": N},
      [...]
    }
  },
  "all_repos_processed": ["repo1", "repo2", ...],
  "all_urls_visited": ["url1", "url2", ...],
  "vendors_catalog": ["Vendor1", "Vendor2", ...],
  "sectors_coverage": {
    "Energy": {
      "pages": N,
      "vendors": N,
      "equipment": N,
      "comprehensive_reports": N,
      "entity_patterns": N,
      "specificity_score": 0.95
    },
    [...]
  },
  "neo4j_tools_catalog": ["tool1", "tool2", ...],
  "threat_intel_sources": ["source1", "source2", ...],
  "pattern_extraction_performance": {
    "total_patterns_extracted": N,
    "vendor_patterns": N,
    "equipment_patterns": N,
    "protocol_patterns": N,
    "operation_patterns": N,
    "architecture_patterns": N,
    "security_patterns": N,
    "f1_score_target": 1.0
  },
  "last_updated": "[TIMESTAMP]"
}
````

## Quality Checklist - OPTIMIZED v2.0
- [ ] **29-36 new KB pages** created with unique timestamps (optimized distribution)
- [ ] **2 comprehensive reports** (facility + control system) if sector research
- [ ] Each comprehensive report **2000+ words** with substantial technical depth
- [ ] Each comprehensive report has **3+ Mermaid diagrams**
- [ ] Each comprehensive report has **8-15 references**
- [ ] **ZERO GENERIC PHRASES** found (various, multiple, several, typical, common)
- [ ] **15+ specific product models** per page (Manufacturer + Model + Specs)
- [ ] **12+ protocol versions** per page (Protocol + Version + Implementation)
- [ ] **3+ vendors per page** with 8+ models each
- [ ] **Entity density targets met**:
  - Security pages: 25-30 security patterns
  - Operations pages: 30-40 operation patterns
  - Architecture pages: 40-50 architecture patterns
  - Vendor pages: 15-20 vendor patterns
  - Equipment pages: 20-25 equipment patterns
  - Protocol pages: 12-15 protocol patterns
- [ ] **4-section structure** enforced on all pages:
  - Section 1: Entity-rich introduction (150-200 words)
  - Section 2: Technical specifications (5-10 bullets with values)
  - Section 3: Integration & operations (200-300 words, 3+ scenarios)
  - Section 4: Security implementation (100-150 words, 3+ technologies)
- [ ] Each standard page has **3+ source URLs** documented
- [ ] **No duplicate content** (check against tracking index)
- [ ] All GitHub repos have README content extracted
- [ ] Vendor/equipment pages include **specific models and protocols WITH VERSIONS**
- [ ] Architecture pages describe **network topology and system integration WITH SPECIFIC EQUIPMENT**
- [ ] Neo4j pages address **300k+ node scale, 12+ domains, 20+ relationships**
- [ ] Visualization pages explain **Cypher query capabilities**
- [ ] Threat intel pages include **actionable IOCs or CVE details WITH VERSIONS**
- [ ] All URLs logged in session tracking file
- [ ] Master index updated with new entities
- [ ] **Cross-references** added between all related pages
- [ ] Comprehensive reports **cross-reference each other**
- [ ] **Pattern extraction validation**:
  - Total patterns ‚â• 650 per session (Manufacturing baseline)
  - OPERATION patterns: 22% of total (140-160 patterns)
  - SECURITY patterns: 21% of total (135-150 patterns)
  - VENDOR patterns: 15% of total (100-120 patterns)
  - ARCHITECTURE patterns: 14% of total (90-110 patterns)
  - EQUIPMENT patterns: 11% of total (70-90 patterns)
  - PROTOCOL patterns: 10% of total (65-85 patterns)
  - SUPPLIER patterns: 7% of total (45-60 patterns)
- [ ] **Specificity validation**:
  - Generic phrase count = 0 (zero tolerance)
  - Specific model count ‚â• 80 unique models per session
  - Protocol version count ‚â• 40 unique versions per session
  - Technical specifications with values ‚â• 500 per session
  - Average models per vendor ‚â• 8
- [ ] **F1 Score validation**: On-track for 100% F1 score based on Manufacturing distribution

Recommended focus areas for next cycle:
[Analyze gaps in master index, suggest 3-5 specific topics to prioritize]
[If sector research next cycle, plan facility types and control approaches to cover]
[Identify entity types below target density for increased focus]

---
END OF RESEARCH SESSION - OPTIMIZED v2.0
Total Expected Output: 29-36 markdown files in kb/ directory structure
- 2 comprehensive architectural reports (2000+ words each)
- 27-34 standard KB pages optimized for 100% F1 score
- 650+ extractable entity patterns following Manufacturing success distribution
- Zero generic phrases, maximum specificity enforcement
- Mandatory 4-section structure on all pages