{
  "schema": {
    "name": "AEON Digital Twin Cyber Security Threat Intelligence",
    "version": "1.0.0",
    "created": "2025-10-29",
    "description": "Complete Neo4j graph schema for railway digital twin cybersecurity",
    "statistics": {
      "nodeTypes": 15,
      "relationshipTypes": 25,
      "constraints": 15,
      "indexes": 60,
      "fullTextIndexes": 5
    }
  },
  "nodeTypes": [
    {
      "label": "Organization",
      "description": "Organizations operating railway systems",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "type": {"type": "STRING", "indexed": true, "values": ["operator", "manufacturer", "regulator"]},
        "country": {"type": "STRING", "indexed": true},
        "sector": {"type": "STRING"},
        "employees": {"type": "INTEGER"},
        "website": {"type": "STRING"},
        "contactEmail": {"type": "STRING"},
        "foundedDate": {"type": "DATE"},
        "description": {"type": "STRING"},
        "riskScore": {"type": "FLOAT"},
        "lastAssessmentDate": {"type": "DATETIME"},
        "certifications": {"type": "LIST<STRING>"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Site",
      "description": "Physical railway sites (stations, depots, control centers)",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "type": {"type": "STRING", "indexed": true, "values": ["station", "depot", "control_center", "maintenance"]},
        "location": {"type": "STRING"},
        "coordinates": {"type": "POINT"},
        "operationalStatus": {"type": "STRING"},
        "capacity": {"type": "INTEGER"},
        "securityLevel": {"type": "STRING"},
        "hasPublicAccess": {"type": "BOOLEAN"},
        "criticalityLevel": {"type": "STRING", "values": ["critical", "high", "medium", "low"]},
        "riskScore": {"type": "FLOAT"},
        "lastInspection": {"type": "DATE"},
        "emergencyContacts": {"type": "LIST<STRING>"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Train",
      "description": "Individual trains or train sets",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "type": {"type": "STRING", "indexed": true, "values": ["passenger", "freight", "high_speed", "metro"]},
        "model": {"type": "STRING"},
        "manufacturer": {"type": "STRING", "indexed": true},
        "yearBuilt": {"type": "INTEGER"},
        "serialNumber": {"type": "STRING"},
        "capacity": {"type": "INTEGER"},
        "maxSpeed": {"type": "INTEGER"},
        "powerType": {"type": "STRING", "values": ["electric", "diesel", "hybrid"]},
        "status": {"type": "STRING", "indexed": true, "values": ["active", "maintenance", "retired"]},
        "lastMaintenance": {"type": "DATE"},
        "nextMaintenance": {"type": "DATE"},
        "operatingRoute": {"type": "STRING"},
        "criticalityLevel": {"type": "STRING"},
        "riskScore": {"type": "FLOAT"},
        "mileage": {"type": "INTEGER"},
        "certifications": {"type": "LIST<STRING>"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Component",
      "description": "Hardware/software components in trains and infrastructure",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "type": {"type": "STRING", "indexed": true, "values": ["PLC", "SCADA", "sensor", "controller", "actuator", "display"]},
        "manufacturer": {"type": "STRING", "indexed": true},
        "model": {"type": "STRING"},
        "version": {"type": "STRING"},
        "serialNumber": {"type": "STRING"},
        "installDate": {"type": "DATE"},
        "warrantyExpires": {"type": "DATE"},
        "criticalityLevel": {"type": "STRING", "indexed": true, "values": ["critical", "high", "medium", "low"]},
        "functionDescription": {"type": "STRING"},
        "networkConnected": {"type": "BOOLEAN"},
        "hasRemoteAccess": {"type": "BOOLEAN"},
        "encryptionEnabled": {"type": "BOOLEAN"},
        "lastUpdate": {"type": "DATETIME"},
        "vendorSupport": {"type": "STRING", "values": ["active", "limited", "eol"]},
        "riskScore": {"type": "FLOAT"},
        "mtbf": {"type": "INTEGER"},
        "maintenanceSchedule": {"type": "STRING"},
        "certifications": {"type": "LIST<STRING>"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Software",
      "description": "Software packages and applications",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "version": {"type": "STRING", "indexed": true},
        "vendor": {"type": "STRING", "indexed": true},
        "type": {"type": "STRING", "indexed": true, "values": ["os", "application", "firmware", "driver", "middleware"]},
        "installDate": {"type": "DATE"},
        "licenseType": {"type": "STRING"},
        "licenseExpires": {"type": "DATE"},
        "purpose": {"type": "STRING"},
        "criticalityLevel": {"type": "STRING"},
        "hasKnownVulnerabilities": {"type": "BOOLEAN"},
        "lastPatched": {"type": "DATETIME"},
        "patchLevel": {"type": "STRING"},
        "supportStatus": {"type": "STRING"},
        "endOfLife": {"type": "DATE"},
        "configFiles": {"type": "LIST<STRING>"},
        "isOpenSource": {"type": "BOOLEAN"},
        "sourceRepository": {"type": "STRING"},
        "riskScore": {"type": "FLOAT"},
        "cpe": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Library",
      "description": "Software libraries and dependencies",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "version": {"type": "STRING", "indexed": true},
        "language": {"type": "STRING"},
        "packageManager": {"type": "STRING"},
        "license": {"type": "STRING"},
        "purpose": {"type": "STRING"},
        "isOpenSource": {"type": "BOOLEAN"},
        "repository": {"type": "STRING"},
        "lastUpdate": {"type": "DATE"},
        "hasKnownVulnerabilities": {"type": "BOOLEAN"},
        "riskScore": {"type": "FLOAT"},
        "popularity": {"type": "INTEGER"},
        "maintainerStatus": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "NetworkInterface",
      "description": "Network interfaces on components",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING"},
        "type": {"type": "STRING", "indexed": true, "values": ["ethernet", "wifi", "serial", "canbus"]},
        "ipAddress": {"type": "STRING", "indexed": true},
        "macAddress": {"type": "STRING", "indexed": true},
        "subnetMask": {"type": "STRING"},
        "gateway": {"type": "STRING"},
        "dnsServers": {"type": "LIST<STRING>"},
        "vlanId": {"type": "INTEGER"},
        "speed": {"type": "INTEGER"},
        "status": {"type": "STRING"},
        "isManagement": {"type": "BOOLEAN"},
        "securityLevel": {"type": "STRING"},
        "firewallEnabled": {"type": "BOOLEAN"},
        "encryptionProtocol": {"type": "STRING"},
        "lastActivity": {"type": "DATETIME"},
        "trafficVolume": {"type": "INTEGER"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "NetworkSegment",
      "description": "Network segments/zones",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true},
        "type": {"type": "STRING", "indexed": true, "values": ["operational", "management", "dmz", "public"]},
        "vlanId": {"type": "INTEGER", "indexed": true},
        "ipRange": {"type": "STRING"},
        "securityZone": {"type": "STRING"},
        "purpose": {"type": "STRING"},
        "isolationLevel": {"type": "STRING"},
        "monitoringEnabled": {"type": "BOOLEAN"},
        "idsEnabled": {"type": "BOOLEAN"},
        "ipsEnabled": {"type": "BOOLEAN"},
        "accessControl": {"type": "STRING"},
        "allowedProtocols": {"type": "LIST<STRING>"},
        "riskScore": {"type": "FLOAT"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "FirewallRule",
      "description": "Firewall rules protecting network segments",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true},
        "priority": {"type": "INTEGER", "indexed": true},
        "action": {"type": "STRING", "indexed": true, "values": ["allow", "deny", "log"]},
        "direction": {"type": "STRING", "values": ["inbound", "outbound", "bidirectional"]},
        "sourceIp": {"type": "STRING"},
        "destinationIp": {"type": "STRING"},
        "sourcePort": {"type": "STRING"},
        "destinationPort": {"type": "STRING"},
        "protocol": {"type": "STRING"},
        "enabled": {"type": "BOOLEAN"},
        "logTraffic": {"type": "BOOLEAN"},
        "description": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "lastModified": {"type": "DATETIME"},
        "createdBy": {"type": "STRING"},
        "reviewDate": {"type": "DATE"}
      }
    },
    {
      "label": "Protocol",
      "description": "Network protocols used in railway systems",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "required": true},
        "version": {"type": "STRING"},
        "type": {"type": "STRING", "indexed": true, "values": ["industrial", "network", "application"]},
        "port": {"type": "INTEGER", "indexed": true},
        "transportProtocol": {"type": "STRING"},
        "isEncrypted": {"type": "BOOLEAN"},
        "authenticationRequired": {"type": "BOOLEAN"},
        "standard": {"type": "STRING"},
        "commonUse": {"type": "STRING"},
        "knownVulnerabilities": {"type": "INTEGER"},
        "riskLevel": {"type": "STRING"},
        "description": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "CVE",
      "description": "Common Vulnerabilities and Exposures",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true, "pattern": "CVE-\\d{4}-\\d{4,}"},
        "description": {"type": "STRING", "fullTextIndexed": true},
        "severity": {"type": "STRING", "indexed": true, "values": ["critical", "high", "medium", "low"]},
        "cvssScore": {"type": "FLOAT", "indexed": true},
        "cvssVector": {"type": "STRING"},
        "publishedDate": {"type": "DATE", "indexed": true},
        "lastModifiedDate": {"type": "DATE"},
        "cweId": {"type": "STRING"},
        "attackVector": {"type": "STRING"},
        "attackComplexity": {"type": "STRING"},
        "privilegesRequired": {"type": "STRING"},
        "userInteraction": {"type": "STRING"},
        "scope": {"type": "STRING"},
        "confidentialityImpact": {"type": "STRING"},
        "integrityImpact": {"type": "STRING"},
        "availabilityImpact": {"type": "STRING"},
        "exploitAvailable": {"type": "BOOLEAN"},
        "patchAvailable": {"type": "BOOLEAN"},
        "workaroundAvailable": {"type": "BOOLEAN"},
        "status": {"type": "STRING", "indexed": true, "values": ["active", "patched", "mitigated"]},
        "impact": {"type": "STRING", "fullTextIndexed": true},
        "mitigation": {"type": "STRING"},
        "references": {"type": "LIST<STRING>"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "ThreatActor",
      "description": "Threat actors and adversary groups",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "fullTextIndexed": true, "required": true},
        "aliases": {"type": "LIST<STRING>", "fullTextIndexed": true},
        "type": {"type": "STRING", "indexed": true, "values": ["nation_state", "cybercrime", "hacktivist", "insider", "terrorist"]},
        "sophisticationLevel": {"type": "STRING", "indexed": true, "values": ["advanced", "intermediate", "basic"]},
        "primaryMotivation": {"type": "STRING", "values": ["financial", "espionage", "ideology", "revenge"]},
        "targetedSectors": {"type": "LIST<STRING>"},
        "targetedCountries": {"type": "LIST<STRING>"},
        "firstSeen": {"type": "DATE"},
        "lastSeen": {"type": "DATE"},
        "isActive": {"type": "BOOLEAN"},
        "attribution": {"type": "STRING", "values": ["confirmed", "suspected", "unknown"]},
        "capabilities": {"type": "LIST<STRING>"},
        "ttps": {"type": "LIST<STRING>"},
        "infrastructure": {"type": "STRING"},
        "toolsUsed": {"type": "LIST<STRING>"},
        "description": {"type": "STRING", "fullTextIndexed": true},
        "riskLevel": {"type": "STRING"},
        "intelligence": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Campaign",
      "description": "Coordinated threat campaigns",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "name": {"type": "STRING", "indexed": true, "fullTextIndexed": true, "required": true},
        "description": {"type": "STRING", "fullTextIndexed": true},
        "objectives": {"type": "LIST<STRING>", "fullTextIndexed": true},
        "startDate": {"type": "DATE", "indexed": true},
        "endDate": {"type": "DATE"},
        "status": {"type": "STRING", "indexed": true, "values": ["active", "concluded", "suspected"]},
        "targetedIndustries": {"type": "LIST<STRING>"},
        "targetedRegions": {"type": "LIST<STRING>"},
        "attackVectors": {"type": "LIST<STRING>"},
        "indicators": {"type": "LIST<STRING>"},
        "victimCount": {"type": "INTEGER"},
        "impactLevel": {"type": "STRING"},
        "detectionRate": {"type": "FLOAT"},
        "preventionGuidance": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "AttackTechnique",
      "description": "MITRE ATT&CK techniques",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "mitreId": {"type": "STRING", "indexed": true, "required": true, "pattern": "T\\d{4}(\\.\\d{3})?"},
        "name": {"type": "STRING", "indexed": true, "fullTextIndexed": true, "required": true},
        "tactic": {"type": "STRING", "indexed": true},
        "description": {"type": "STRING", "fullTextIndexed": true},
        "platforms": {"type": "LIST<STRING>"},
        "dataSourcesRequired": {"type": "LIST<STRING>"},
        "detection": {"type": "STRING", "fullTextIndexed": true},
        "mitigation": {"type": "STRING"},
        "examples": {"type": "LIST<STRING>"},
        "subtechniques": {"type": "LIST<STRING>"},
        "difficulty": {"type": "STRING", "values": ["low", "medium", "high"]},
        "commonInRailway": {"type": "BOOLEAN"},
        "riskLevel": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    },
    {
      "label": "Document",
      "description": "Security documents, reports, and policies",
      "properties": {
        "id": {"type": "STRING", "unique": true, "required": true},
        "title": {"type": "STRING", "indexed": true, "fullTextIndexed": true, "required": true},
        "type": {"type": "STRING", "indexed": true, "values": ["policy", "report", "assessment", "procedure", "standard"]},
        "content": {"type": "STRING", "fullTextIndexed": true},
        "summary": {"type": "STRING", "fullTextIndexed": true},
        "author": {"type": "STRING"},
        "version": {"type": "STRING"},
        "status": {"type": "STRING", "values": ["draft", "published", "archived"]},
        "classification": {"type": "STRING"},
        "createdDate": {"type": "DATE", "indexed": true},
        "publishedDate": {"type": "DATE"},
        "reviewDate": {"type": "DATE"},
        "expiryDate": {"type": "DATE"},
        "approvedBy": {"type": "STRING"},
        "tags": {"type": "LIST<STRING>"},
        "relatedStandards": {"type": "LIST<STRING>"},
        "filePath": {"type": "STRING"},
        "fileHash": {"type": "STRING"},
        "created": {"type": "DATETIME"},
        "modified": {"type": "DATETIME"}
      }
    }
  ],
  "relationshipTypes": [
    {"type": "OPERATES", "from": "Organization", "to": "Site", "description": "Organization operates Sites"},
    {"type": "HOSTS", "from": "Site", "to": "Train", "description": "Site hosts Trains"},
    {"type": "HAS_COMPONENT", "from": ["Train", "Site"], "to": "Component", "description": "Asset has Components"},
    {"type": "RUNS_SOFTWARE", "from": "Component", "to": "Software", "description": "Component runs Software"},
    {"type": "DEPENDS_ON", "from": "Software", "to": "Library", "description": "Software depends on Library"},
    {"type": "HAS_VULNERABILITY", "from": ["Software", "Component", "Library"], "to": "CVE", "description": "Asset has CVE"},
    {"type": "HAS_INTERFACE", "from": "Component", "to": "NetworkInterface", "description": "Component has NetworkInterface"},
    {"type": "BELONGS_TO", "from": "NetworkInterface", "to": "NetworkSegment", "description": "Interface belongs to Segment"},
    {"type": "CONNECTS_TO", "from": "NetworkSegment", "to": "NetworkSegment", "description": "Segment connects to Segment"},
    {"type": "PROTECTED_BY", "from": "NetworkSegment", "to": "FirewallRule", "description": "Segment protected by Rule"},
    {"type": "USES_PROTOCOL", "from": ["Component", "Software"], "to": "Protocol", "description": "Asset uses Protocol"},
    {"type": "EXPLOITS", "from": "ThreatActor", "to": "CVE", "description": "ThreatActor exploits CVE"},
    {"type": "TARGETS", "from": "ThreatActor", "to": "Organization", "description": "ThreatActor targets Organization"},
    {"type": "CONDUCTS", "from": "ThreatActor", "to": "Campaign", "description": "ThreatActor conducts Campaign"},
    {"type": "USES", "from": ["ThreatActor", "Campaign"], "to": "AttackTechnique", "description": "Actor uses Technique"},
    {"type": "TARGETS_SECTOR", "from": "Campaign", "to": "Organization", "description": "Campaign targets sector"},
    {"type": "MENTIONS", "from": "Document", "to": ["CVE", "ThreatActor", "Campaign"], "description": "Document mentions entity"},
    {"type": "DESCRIBES", "from": "Document", "to": "AttackTechnique", "description": "Document describes Technique"},
    {"type": "ATTACK_PATH_STEP", "from": ["NetworkSegment", "Component"], "to": ["NetworkSegment", "Component"], "description": "Attack path step"},
    {"type": "MITIGATES", "from": ["FirewallRule", "Component"], "to": ["CVE", "ThreatActor"], "description": "Control mitigates threat"},
    {"type": "MONITORS", "from": "Component", "to": ["Component", "NetworkSegment"], "description": "System monitors asset"},
    {"type": "AUTHENTICATES", "from": "Component", "to": "Component", "description": "Authentication relationship"},
    {"type": "SUPPLIES", "from": "Organization", "to": ["Component", "Software"], "description": "Vendor supplies asset"},
    {"type": "REQUIRES_UPDATE", "from": ["Component", "Software"], "to": "CVE", "description": "Asset requires update"},
    {"type": "COMMUNICATES_WITH", "from": "Component", "to": "Component", "description": "Component communicates with Component"}
  ]
}
